{
    "frontend/index.html": "<!DOCTYPE html>\n<html lang=\"es\">\n  <head>\n    <meta charset=\"UTF-8\" />\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1\" />\n    <title>Rental-MVP</title>\n    <link rel=\"preconnect\" href=\"https://fonts.googleapis.com\">\n  <link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin>\n  <link href=\"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap\" rel=\"stylesheet\">\n  </head>\n  <body>\n    <div id=\"root\"></div>\n    <script type=\"module\" src=\"/src/main.tsx\"></script>\n  </body>\n</html>\n",
    "frontend/package.json": "{\n  \"name\": \"rental-mvp-frontend\",\n  \"version\": \"0.1.0\",\n  \"private\": true,\n  \"type\": \"module\",\n  \"scripts\": {\n    \"dev\": \"vite\",\n    \"build\": \"vite build\",\n    \"preview\": \"vite preview\",\n    \"lint\": \"eslint \\\"src/**/*.{ts,tsx}\\\" --max-warnings=0 --fix\"\n  },\n  \"dependencies\": {\n    \"@headlessui/react\": \"^2.2.4\",\n    \"@heroicons/react\": \"^2.2.0\",\n    \"@hookform/resolvers\": \"^3.3.4\",\n    \"@stripe/react-stripe-js\": \"^2.3.0\",\n    \"@stripe/stripe-js\": \"^1.53.0\",\n    \"@tanstack/react-query\": \"^5.38.0\",\n    \"axios\": \"^1.6.8\",\n    \"clsx\": \"^2.1.1\",\n    \"date-fns\": \"^4.1.0\",\n    \"focus-trap-react\": \"^10.2.1\",\n    \"react\": \"^18.3.1\",\n    \"react-day-picker\": \"^9.8.0\",\n    \"react-dom\": \"^18.3.1\",\n    \"react-hook-form\": \"^7.60.0\",\n    \"react-hot-toast\": \"^2.5.2\",\n    \"react-icons\": \"^5.5.0\",\n    \"react-router-dom\": \"^6.23.1\",\n    \"react-swipeable\": \"^7.0.2\",\n    \"zod\": \"^3.23.4\",\n    \"zxcvbn\": \"^4.4.2\"\n  },\n  \"devDependencies\": {\n    \"@tailwindcss/aspect-ratio\": \"^0.4.2\",\n    \"@tailwindcss/container-queries\": \"\",\n    \"@tailwindcss/forms\": \"^0.5.10\",\n    \"@tailwindcss/line-clamp\": \"^0.4.4\",\n    \"@tailwindcss/typography\": \"^0.5.16\",\n    \"@types/react\": \"^18.3.5\",\n    \"@types/react-dom\": \"^18.3.2\",\n    \"@typescript-eslint/eslint-plugin\": \"^7.18.0\",\n    \"@typescript-eslint/parser\": \"^7.18.0\",\n    \"@vitejs/plugin-react\": \"^4.2.0\",\n    \"autoprefixer\": \"^10.4.20\",\n    \"eslint\": \"^8.57.0\",\n    \"eslint-plugin-react\": \"^7.34.1\",\n    \"eslint-plugin-react-hooks\": \"^4.6.0\",\n    \"postcss\": \"^8.4.38\",\n    \"tailwindcss\": \"^3.4.4\",\n    \"typescript\": \"^5.5.0\",\n    \"vite\": \"^5.3.1\"\n  }\n}\n",
    "frontend/vite.config.ts": "import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\n\nexport default defineConfig({\n  plugins: [react()],\n  server: {\n    port: 5173,\n    https: true,  // MODIFIED: HTTPS en dev (usa cert auto-firmado de Vite)\n    proxy: {\n      \"/api/auth\":       \"https://localhost:8001\",  // MODIFIED: Cambiado a HTTPS\n      \"/api/items\":      \"https://localhost:8002\",\n      \"/api/categories\": \"https://localhost:8002\",\n      \"/api/rentals\":    \"https://localhost:8003\",\n      \"/api/upload\":     \"https://localhost:8004\",\n      \"/api/payments\":   \"https://localhost:8005\",\n      \"/uploads\":        \"https://localhost:8004\"\n    }\n  },\n  build: {\n    commonjsOptions: {\n      transformMixedEsModules: true  // This forces proper transformation of mixed ESM/CJS modules like clsx\n    }\n  }\n});",
    "frontend/.env": "VITE_STRIPE_PK=pk_test_51RkNe1BAdmER2zaJNEdcxq6T7uBwtyGDiHaFRF5I9LjGGbbYxmvPfdffr4HLqZy753gB6ixJRFfu7HXRsntuCGyH00szhzRTcx\nFRONTEND_URL=http://frontend\n",
    "frontend/Dockerfile": "# ───────────── Etapa 1: build Vite ─────────────\nFROM node:20 AS builder\nWORKDIR /frontend\n\nCOPY package.json package-lock.json* ./\nRUN npm ci\n\nCOPY . .\nRUN npm run build          # genera /frontend/dist\n\n# ───────────── Etapa 2: Nginx ─────────────\nFROM nginx:1.27-alpine\n\nRUN apk add --no-cache curl  # Para healthcheck\n\n# Copia estáticos compilados\nCOPY --from=builder /frontend/dist /usr/share/nginx/html\n\n# Proxy /api → backend\nCOPY nginx.conf /etc/nginx/conf.d/default.conf\n\nEXPOSE 80\nCMD [\"nginx\", \"-g\", \"daemon off;\"]",
    "frontend/nginx.conf": "server {\n    listen 80;\n    server_name 15.188.100.106;  # O localhost para testing local\n\n    # Redirigir todo HTTP a HTTPS (opcional, pero recomendado)\n    location / {\n        return 301 https://$host$request_uri;\n    }\n}\n\nserver {\n    listen 443 ssl;\n    server_name 15.188.100.106;  # O localhost\n\n    # Self-signed certificates (montados via volumen)\n    ssl_certificate /etc/nginx/certs/selfsigned.crt;\n    ssl_certificate_key /etc/nginx/certs/selfsigned.key;\n\n    # Config básica de seguridad (sin HSTS para self-signed)\n    ssl_protocols TLSv1.2 TLSv1.3;\n    ssl_ciphers HIGH:!aNULL:!MD5;\n\n    # ───────── Cabeceras comunes para upstream ─────────\n    proxy_set_header Host              $host;\n    proxy_set_header X-Real-IP         $remote_addr;\n    proxy_set_header X-Forwarded-For   $proxy_add_x_forwarded_for;\n    proxy_set_header X-Forwarded-Proto $scheme;\n\n    # ───────── Fichero SPA (Vite) ─────────\n    root /usr/share/nginx/html;\n    index index.html;\n    client_max_body_size 100M;\n\n    # ───────── Health-check global ─────────\n    location = /health {\n        proxy_pass http://auth-service:8000;\n    }\n\n    # ───────── Micro-servicios ─────────\n    location /api/auth/       { proxy_pass http://auth-service:8000; }\n    location /api/items/      { proxy_pass http://catalog-service:8000; }\n    location /api/categories/ { proxy_pass http://catalog-service:8000; }\n    location /api/rentals/    { proxy_pass http://rentals-service:8000; }\n    location /api/upload/     { proxy_pass http://upload-service:8000; }\n    location /api/payments/   { proxy_pass http://payments-service:8000; }\n\n    # Ficheros subidos\n    location /uploads/        { proxy_pass http://upload-service:8000; }\n\n    # ───────── SPA fallback ─────────\n    location / {\n        try_files $uri $uri/ /index.html;\n    }\n}",
    "frontend/tsconfig.json": "{\n    \"compilerOptions\": {\n        \"target\": \"ES2022\",\n        \"lib\": [\n            \"DOM\",\n            \"DOM.Iterable\",\n            \"ES2022\"\n        ],\n        \"module\": \"ESNext\",\n        \"moduleResolution\": \"Node\",\n        \"types\": [\n            \"vite/client\"\n        ],\n        \"strict\": true,\n        \"jsx\": \"react-jsx\",\n        \"resolveJsonModule\": true,\n        \"esModuleInterop\": true,\n        \"skipLibCheck\": true,\n        \"forceConsistentCasingInFileNames\": true\n    },\n    \"include\": [\n        \"src\"\n    ]\n}",
    "frontend/postcss.config.js": "// rental-mvp/frontend/postcss.config.js\nexport default {\n    plugins: {\n        tailwindcss: {},\n        autoprefixer: {}\n    }\n};\n",
    "frontend/tailwind.config.js": "/** @type {import('tailwindcss').Config} */\nmodule.exports = {\n    darkMode: 'class',        // Activa el modo oscuro por clase\n    content: ['./index.html', './src/**/*.{ts,tsx}'],\n\n    /* ───── Diseño básico ─────────────────────────────────────────────── */\n    theme: {\n        /* Breakpoints fluidos */\n        screens: {\n            xs: '375px',\n            sm: '640px',\n            md: '768px',\n            lg: '1024px',\n            xl: '1280px',\n            '2xl': '1440px',\n            '3xl': '1920px',\n        },\n\n        /* Contenedor centrado */\n        container: { center: true, padding: '1rem' },\n\n        /* Tipografía por defecto */\n        fontFamily: { sans: ['Inter', 'system-ui', 'sans-serif'] },\n\n        /* ───── Extensiones (diseño tokens) ─────────────────────────────── */\n        extend: {\n            /* Paleta de marca accesible (AA) */\n            colors: {\n                brand: {\n                    DEFAULT: '#0e9f6e',     // Contraste 4.5:1 con #fff y #0f172a :contentReference[oaicite:1]{index=1}\n                    light: '#34d399',\n                    hover: '#0fbf7f',\n                    dark: '#047857',\n                    'hover-dark': '#03563b',\n                },\n                surface: '#ffffff',\n                'surface-dark': '#1f2937',\n            },\n\n            /* Sombras coherentes */\n            boxShadow: {\n                card: '0 1px 3px rgba(0,0,0,.08)',\n                cardHover: '0 4px 12px rgba(0,0,0,.12)',\n            },\n\n            /* Keyframes reutilizables */\n            keyframes: {\n                'fade-in': {\n                    '0%': { opacity: 0, transform: 'translateY(12px)' },\n                    '100%': { opacity: 1, transform: 'translateY(0)' },\n                },\n                marquee: {\n                    '0%': { transform: 'translateX(0)' },\n                    '100%': { transform: 'translateX(-50%)' },\n                },\n            },\n\n            /* Atajos de animación */\n            animation: {\n                'fade-in': 'fade-in 400ms ease-out forwards',\n                marquee: 'marquee 25s linear infinite',\n            },\n        },\n    },\n\n    /* ───── Plugins oficiales ─────────────────────────────────────────── */\n    plugins: [\n        require('@tailwindcss/forms'),            // Inputs coherentes :contentReference[oaicite:2]{index=2}\n        require('@tailwindcss/typography'),       // Prosa optimizada\n        require('@tailwindcss/line-clamp'),       // Clamp de texto\n        require('@tailwindcss/container-queries'),// Consultas de contenedor :contentReference[oaicite:3]{index=3}\n        require('@tailwindcss/aspect-ratio'),     // Control de aspect‑ratio\n    ],\n};\n",
    "frontend/src/App.tsx": "// src/App.tsx\nimport { BrowserRouter, Routes, Route } from \"react-router-dom\";\nimport { Suspense } from \"react\";\nimport { QueryClient, QueryClientProvider } from \"@tanstack/react-query\";\nimport { Elements } from \"@stripe/react-stripe-js\";\nimport { loadStripe } from \"@stripe/stripe-js\";\n\nimport ErrorBoundary from \"./ErrorBoundary\";\nimport { AuthProvider } from \"./hooks/useAuth\";\n\nimport Header from \"./components/layout/Header\";\nimport Footer from \"./components/layout/Footer\";\n\nimport Home from \"./pages/Home\";\nimport Login from \"./pages/Login\";\nimport Register from \"./pages/Register\";\nimport Dashboard from \"./pages/Dashboard\";\nimport Protected from \"./Protected\";\nimport ForgotPassword from \"./pages/ForgotPassword\";    \nimport ResetPassword from \"./pages/ResetPassword\";  \n\nimport \"./styles/global.css\";\n\n/* ─── Stripe ─────────────────────────────────────────────────────────── */\nconst stripePromise = loadStripe(\n  import.meta.env.VITE_STRIPE_PK as string /* pk_test_xxx */\n);\n/* ─────────────────────────────────────────────────────────────────────── */\n\nconst queryClient = new QueryClient();\n\nexport default function App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <AuthProvider>\n        <Elements stripe={stripePromise}>\n          <BrowserRouter>\n            <ErrorBoundary>\n              <Header />\n\n              <Suspense\n                fallback={\n                  <p className=\"py-32 text-center text-gray-500\">Cargando…</p>\n                }\n              >\n                <Routes>\n                  <Route path=\"/\" element={<Home />} />\n                  <Route path=\"/login\" element={<Login />} />\n                  <Route path=\"/register\" element={<Register />} />\n                  <Route path=\"/forgot-password\" element={<ForgotPassword />} />  \n                  <Route path=\"/reset-password\" element={<ResetPassword />} />   \n                  {/* ---------- RUTA PROTEGIDA ---------- */}\n                  <Route\n                    path=\"/dashboard\"\n                    element={\n                      <Protected>\n                        <Dashboard />\n                      </Protected>\n                    }\n                  />\n                </Routes>\n              </Suspense>\n\n              <Footer />\n            </ErrorBoundary>\n          </BrowserRouter>\n        </Elements>\n      </AuthProvider>\n    </QueryClientProvider>\n  );\n}\n",
    "frontend/src/api.ts": "import axios from \"axios\";\n\n/**\n * Singleton Axios con:\n *  · baseURL \"/api\"\n *  · Authorization automático si hay token en localStorage\n */\nexport const api = axios.create({ baseURL: \"/api\" });\n\napi.interceptors.request.use(cfg => {\n  const token = localStorage.getItem(\"token\");\n  if (token) cfg.headers.Authorization = `Bearer ${token}`;\n  cfg.withCredentials = true;  // MODIFIED: Para CSRF si backend usa cookies (opcional)\n  return cfg;\n});",
    "frontend/src/ErrorBoundary.tsx": "import React, { ErrorInfo, ReactNode } from \"react\";\n\ntype Props = { children: ReactNode };\ntype State = { hasError: boolean };\n\nclass ErrorBoundary extends React.Component<Props, State> {\n  state: State = { hasError: false };\n\n  static getDerivedStateFromError() {\n    return { hasError: true };\n  }\n\n  componentDidCatch(error: Error, info: ErrorInfo) {\n    // Aquí podrías enviar logs a Sentry, LogRocket, etc.\n    console.error(\"⛔ Unhandled error:\", error, info);\n  }\n\n  render() {\n    if (this.state.hasError) {\n      return (\n        <main className=\"flex min-h-[60vh] items-center justify-center\">\n          <p className=\"rounded-md bg-red-50 p-6 text-center text-lg text-red-600 shadow\">\n            ¡Ups! Algo ha ido mal.<br />\n            Intenta recargar la página.\n          </p>\n        </main>\n      );\n    }\n    return this.props.children;\n  }\n}\n\nexport default ErrorBoundary;\n",
    "frontend/src/main.tsx": "// src/main.tsx\nimport React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport App from './App';\nimport { Toaster } from 'react-hot-toast';          // 🆕\nimport './styles/global.css';\n\nReactDOM.createRoot(document.getElementById('root') as HTMLElement).render(\n  <React.StrictMode>\n    <App />\n    <Toaster                                         // 🆕\n      position=\"top-right\"\n      toastOptions={{\n        style: { fontSize: '0.875rem' },            // 14 px\n        duration: 3000\n      }}\n    />\n  </React.StrictMode>\n);\n",
    "frontend/src/utils.ts": "// utils.ts\n/**\n * URL base de la API.  Ajusta en .env.local si no usas localhost:8000\n *   VITE_API_BASE_URL=https://tu-dominio.com\n */\nexport const API_BASE =\n  import.meta.env.VITE_API_BASE_URL ?? window.location.origin;\n\n/**  \n * Devuelve una URL de imagen válida.\n * - Si ya es absoluta → la deja tal cual.\n * - Si empieza por “/” → la concatena con API_BASE.\n * - Si viene `undefined` → usa el *fallback*.\n */\nexport function resolveImage(url: string | undefined, fallback: string) {\n  if (!url) return fallback;\n  if (/^https?:\\/\\//i.test(url)) return url; // absoluta\n  return `${API_BASE}${url.startsWith(\"/\") ? \"\" : \"/\"}${url}`;\n}\n",
    "frontend/src/Protected.tsx": "import { Navigate, useLocation } from \"react-router-dom\";\nimport { useAuth } from \"./hooks/useAuth\";\n\nexport default function Protected({ children }: { children: JSX.Element }) {\n  const { token } = useAuth();\n  const loc = useLocation();\n  return token ? children : <Navigate to=\"/login\" replace state={{ from: loc }} />;\n}\n",
    "frontend/src/assets/payments/paypal.svg": "<?xml version=\"1.0\" encoding=\"utf-8\"?><!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->\n<svg width=\"800px\" height=\"800px\" viewBox=\"0 0 48 48\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<circle cx=\"24\" cy=\"24\" r=\"20\" fill=\"#0070BA\"/>\n<path d=\"M32.3305 18.0977C32.3082 18.24 32.2828 18.3856 32.2542 18.5351C31.2704 23.5861 27.9046 25.331 23.606 25.331H21.4173C20.8916 25.331 20.4486 25.7127 20.3667 26.2313L19.2461 33.3381L18.9288 35.3527C18.8755 35.693 19.1379 36 19.4815 36H23.3634C23.8231 36 24.2136 35.666 24.286 35.2127L24.3241 35.0154L25.055 30.3772L25.1019 30.1227C25.1735 29.6678 25.5648 29.3338 26.0245 29.3338H26.6051C30.3661 29.3338 33.3103 27.8068 34.1708 23.388C34.5303 21.5421 34.3442 20.0008 33.393 18.9168C33.1051 18.59 32.748 18.3188 32.3305 18.0977Z\" fill=\"white\" fill-opacity=\"0.6\"/>\n<path d=\"M31.3009 17.6871C31.1506 17.6434 30.9955 17.6036 30.8364 17.5678C30.6766 17.5328 30.5127 17.5018 30.3441 17.4748C29.754 17.3793 29.1074 17.334 28.4147 17.334H22.5676C22.4237 17.334 22.2869 17.3666 22.1644 17.4254C21.8948 17.5551 21.6944 17.8104 21.6459 18.1229L20.402 26.0013L20.3662 26.2311C20.4481 25.7126 20.8911 25.3308 21.4168 25.3308H23.6055C27.9041 25.3308 31.2699 23.5851 32.2537 18.5349C32.2831 18.3854 32.3078 18.2398 32.33 18.0975C32.0811 17.9655 31.8115 17.8525 31.5212 17.7563C31.4496 17.7324 31.3757 17.7094 31.3009 17.6871Z\" fill=\"white\" fill-opacity=\"0.8\"/>\n<path d=\"M21.6461 18.1231C21.6946 17.8105 21.895 17.5552 22.1646 17.4264C22.2879 17.3675 22.4239 17.3349 22.5678 17.3349H28.4149C29.1077 17.3349 29.7542 17.3803 30.3444 17.4757C30.513 17.5027 30.6768 17.5338 30.8367 17.5687C30.9957 17.6045 31.1508 17.6443 31.3011 17.688C31.3759 17.7103 31.4498 17.7334 31.5222 17.7564C31.8125 17.8527 32.0821 17.9664 32.331 18.0976C32.6237 16.231 32.3287 14.9601 31.3194 13.8093C30.2068 12.5424 28.1986 12 25.629 12H18.169C17.6441 12 17.1963 12.3817 17.1152 12.9011L14.0079 32.5969C13.9467 32.9866 14.2473 33.3381 14.6402 33.3381H19.2458L20.4022 26.0014L21.6461 18.1231Z\" fill=\"white\"/>\n</svg>",
    "frontend/src/assets/payments/mastercard.svg": "<?xml version=\"1.0\" encoding=\"utf-8\"?><!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->\n<svg width=\"800px\" height=\"800px\" viewBox=\"0 -11 70 70\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<rect x=\"0.5\" y=\"0.5\" width=\"69\" height=\"47\" rx=\"5.5\" fill=\"white\" stroke=\"#D9D9D9\"/>\n<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M35.3945 34.7619C33.0114 36.8184 29.92 38.0599 26.5421 38.0599C19.0047 38.0599 12.8945 31.8788 12.8945 24.254C12.8945 16.6291 19.0047 10.448 26.5421 10.448C29.92 10.448 33.0114 11.6895 35.3945 13.7461C37.7777 11.6895 40.869 10.448 44.247 10.448C51.7843 10.448 57.8945 16.6291 57.8945 24.254C57.8945 31.8788 51.7843 38.0599 44.247 38.0599C40.869 38.0599 37.7777 36.8184 35.3945 34.7619Z\" fill=\"#ED0006\"/>\n<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M35.3945 34.7619C38.3289 32.2296 40.1896 28.4616 40.1896 24.254C40.1896 20.0463 38.3289 16.2783 35.3945 13.7461C37.7777 11.6895 40.869 10.448 44.247 10.448C51.7843 10.448 57.8945 16.6291 57.8945 24.254C57.8945 31.8788 51.7843 38.0599 44.247 38.0599C40.869 38.0599 37.7777 36.8184 35.3945 34.7619Z\" fill=\"#F9A000\"/>\n<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M35.3946 13.7461C38.329 16.2784 40.1897 20.0463 40.1897 24.254C40.1897 28.4616 38.329 32.2295 35.3946 34.7618C32.4603 32.2295 30.5996 28.4616 30.5996 24.254C30.5996 20.0463 32.4603 16.2784 35.3946 13.7461Z\" fill=\"#FF5E00\"/>\n</svg>",
    "frontend/src/assets/payments/visa.svg": "<?xml version=\"1.0\" encoding=\"utf-8\"?>\n\n<!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->\n<svg width=\"800px\" height=\"800px\" viewBox=\"0 -139.5 750 750\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n    \n    <desc>Created with Sketch.</desc>\n    <defs>\n\n</defs>\n    <g id=\"Page-1\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n        <g id=\"visa\" fill=\"#393939\" fill-rule=\"nonzero\">\n            <path d=\"M52.8846154,28.2035928 C39.6085397,28.2035928 28.8461538,38.7262417 28.8461538,51.7065868 L28.8461538,419.293413 C28.8461538,432.273758 39.6085397,442.796407 52.8846154,442.796407 L697.115385,442.796407 C710.39146,442.796407 721.153846,432.273758 721.153846,419.293413 L721.153846,51.7065868 C721.153846,38.7262417 710.39146,28.2035928 697.115385,28.2035928 L52.8846154,28.2035928 Z M52.8846154,0 L697.115385,0 C726.322751,-5.0099645e-15 750,23.1498275 750,51.7065868 L750,419.293413 C750,447.850173 726.322751,471 697.115385,471 L52.8846154,471 C23.6772488,471 3.41607085e-15,447.850173 0,419.293413 L0,51.7065868 C-3.41607085e-15,23.1498275 23.6772488,5.0099645e-15 52.8846154,0 Z\" id=\"outline\">\n\n</path>\n            <g id=\"Logo\" transform=\"translate(60.000000, 139.000000)\">\n                <polygon id=\"Shape\" points=\"222.597614 191.12625 254.442205 4.26252273 305.375795 4.26252273 273.50925 191.12625\">\n\n</polygon>\n                <path d=\"M457.520795,8.29261364 C447.429341,4.50688636 431.61825,0.444340909 411.871568,0.444340909 C361.544114,0.444340909 326.092295,25.7884773 325.790659,62.1117955 C325.507159,88.9622045 351.099477,103.940932 370.419477,112.879295 C390.244432,122.038159 396.910023,127.879977 396.815523,136.058523 C396.689523,148.584068 380.983432,154.306568 366.343568,154.306568 C345.957341,154.306568 335.127068,151.474432 318.400568,144.497659 L311.837114,141.527114 L304.688523,183.359114 C316.585023,188.57475 338.583477,193.094523 361.424795,193.328386 C414.964295,193.328386 449.721205,168.274432 450.116386,129.486477 C450.30825,108.229705 436.738432,92.0520682 407.353705,78.7161136 C389.550477,70.07175 378.647659,64.3034318 378.763159,55.55025 C378.763159,47.7831136 387.991705,39.4776136 407.931205,39.4776136 C424.587068,39.2189318 436.651568,42.8509773 446.051932,46.6367045 L450.616568,48.7930227 L457.520795,8.29261364\" id=\"Shape\">\n\n</path>\n                <path d=\"M588.586568,4.26252273 L549.229705,4.26252273 C537.037295,4.26252273 527.91375,7.59006818 522.55875,19.7586136 L446.915795,191.006932 L500.399932,191.006932 C500.399932,191.006932 509.145477,167.981386 511.123295,162.926114 C516.967977,162.926114 568.924841,163.006295 576.353114,163.006295 C577.876568,169.547795 582.550023,191.006932 582.550023,191.006932 L629.811477,191.006932 L588.586568,4.26252273 Z M526.143068,124.92375 C530.355477,114.157432 546.43575,72.6881591 546.43575,72.6881591 C546.135068,73.1854773 550.616659,61.8693409 553.189159,54.8534318 L556.632205,70.96425 C556.632205,70.96425 566.384795,115.569205 568.42275,124.922795 L526.143068,124.922795 L526.143068,124.92375 Z\" id=\"Path\">\n\n</path>\n                <path d=\"M179.361477,4.26252273 L129.496023,131.689568 L124.183023,105.793705 C114.900068,75.94125 85.9773409,43.5993409 53.6430682,27.4073864 L99.2388409,190.828432 L153.127705,190.766386 L233.313341,4.26252273 L179.361477,4.26252273\" id=\"Path\">\n\n</path>\n                <path d=\"M82.9686136,4.26252273 L0.838568182,4.26252273 L0.188522727,8.15038636 C64.0848409,23.6178409 106.364523,60.9968864 123.914795,105.909205 L106.056205,20.0382955 C102.973023,8.20575 94.0308409,4.67488636 82.9686136,4.26252273\" id=\"Shape\">\n\n</path>\n            </g>\n        </g>\n    </g>\n</svg>",
    "frontend/src/hooks/useAuth.tsx": "import React, { createContext, useContext, useState } from \"react\";\n\n/* ------------------------------------------------------------------ */\n/*                       Contexto & proveedor                         */\n/* ------------------------------------------------------------------ */\ntype AuthContextT = {\n  token: string | null;\n  login: (t: string) => void;\n  logout: () => void;\n};\nconst AuthContext = createContext<AuthContextT | undefined>(undefined);\n\nexport const AuthProvider: React.FC<{ children: React.ReactNode }> = ({\n  children\n}) => {\n  const [token, setToken] = useState<string | null>(\n    () => localStorage.getItem(\"token\")\n  );\n\n  const login = (t: string) => {\n    localStorage.setItem(\"token\", t);\n    setToken(t);\n  };\n\n  const logout = () => {\n    localStorage.removeItem(\"token\");\n    setToken(null);\n  };\n\n  return (\n    <AuthContext.Provider value={{ token, login, logout }}>\n      {children}\n    </AuthContext.Provider>\n  );\n};\n\n/* ------------------------------------------------------------------ */\n/*                           Hooks util                               */\n/* ------------------------------------------------------------------ */\nexport const useAuth = () => {\n  const ctx = useContext(AuthContext);\n  if (!ctx) throw new Error(\"useAuth debe usarse dentro de <AuthProvider>\");\n  return ctx;\n};\n\n/** Lee el token directo de localStorage (válido fuera de React). */\nexport const getTokenLS = () => localStorage.getItem(\"token\");\n",
    "frontend/src/hooks/useStripe.ts": "// src/hooks/useStripe.ts\nimport { loadStripe, Stripe } from \"@stripe/stripe-js\";\nimport { useEffect, useState } from \"react\";\n\nexport function useStripe() {\n  const [stripe, setStripe] = useState<Stripe | null>(null);\n\n  useEffect(() => {\n    (async () => {\n      const pk = import.meta.env.VITE_STRIPE_PK;\n      if (pk && !stripe) {\n        const s = await loadStripe(pk);\n        setStripe(s);\n      }\n    })();\n  }, [stripe]);\n\n  return stripe;\n}\n",
    "frontend/src/styles/global.css": "/* frontend/src/styles/global.css */\n@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n/* ---------- BASE ---------- */\n@layer base {\n  html { @apply scroll-smooth; }\n\n  /** Fondo general + noise decorativo */\n  body {\n    @apply bg-gray-50 text-gray-800 antialiased font-sans dark:bg-gray-900 dark:text-gray-100;\n    background-image: url(\"data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjAwIDIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZmlsdGVyIGlkPSJub2lzZUZpbHRlciI+CiAgICA8ZmVUdXJidWxlbmNlIHR5cGU9ImZyYWN0YWxOb2lzZSIgYmFzZUZyZXF1ZW5jeT0iMC45IiBudW1PY3RhdmVzPSIzIiBzdGl0Y2hUaWxlcz0ic3RpdGNoIi8+CiAgPC9maWx0ZXI+CiAgPHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsdGVyPSJ1cmwoI25vaXNlRmlsdGVyKSIgb3BhY2l0eT0iMC4xIi8+ICA8IS0tPC9zdmc+\");\n    background-repeat: repeat;\n    background-blend-mode: overlay;\n  }\n\n  /* --- Paleta “surface” auto‑adaptativa ---------------------------- */\n  :root {\n    --surface-light: #ffffff;   /* gris 0  */\n    --surface-dark:  #1f2937;   /* gris 800 */\n  }\n  @media (prefers-color-scheme: dark) {\n    :root { --surface-light: var(--surface-dark); }\n  }\n}\n\n/* ---------- COMPONENTS ---------- */\n@layer components {\n  /* Botones */\n  .btn        { @apply inline-flex items-center justify-center rounded-md bg-brand px-4 py-2 text-sm font-medium text-white shadow-sm transition-all duration-200 hover:bg-brand-hover hover:shadow-md hover:scale-105 focus:ring-2 focus:ring-brand focus:ring-offset-2 disabled:opacity-60 disabled:cursor-not-allowed active:scale-95 dark:bg-brand-dark dark:hover:bg-brand-hover-dark; }\n  .btn--secondary { @apply inline-flex items-center justify-center rounded-md bg-gray-200 px-4 py-2 text-sm font-medium text-gray-800 shadow-sm transition-all duration-200 hover:bg-gray-300 hover:shadow-md hover:scale-105 focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 disabled:opacity-60 active:scale-95 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600; }\n  .btn--danger { @apply inline-flex items-center justify-center rounded-md bg-red-600 px-4 py-2 text-sm font-medium text-white shadow-sm transition-all duration-200 hover:bg-red-700 hover:shadow-md hover:scale-105 focus:ring-2 focus:ring-red-500 focus:ring-offset-2 disabled:opacity-60 active:scale-95 dark:bg-red-700 dark:hover:bg-red-800; }\n  .btn--ghost { @apply inline-flex items-center justify-center rounded-md border border-brand px-4 py-2 text-sm font-medium text-brand transition-all duration-200 hover:bg-brand/5 hover:shadow-sm hover:scale-105 focus:ring-2 focus:ring-brand focus:ring-offset-2 active:scale-95 dark:border-brand-dark dark:text-brand-dark dark:hover:bg-brand-dark/10; }\n\n  /* Badges */\n  .badge         { @apply inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium; }\n  .badge--ok     { @apply badge bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200; }\n  .badge--danger { @apply badge bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200; }\n\n  /* Select genérico */\n  .form-select { @apply block w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-brand focus:ring-brand transition-all duration-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-200; }\n\n  /* Toast */\n  .toast-success { @apply bg-green-600 text-white dark:bg-green-700; }\n  .toast-error   { @apply bg-red-600 text-white dark:bg-red-700; }\n\n  /* Títulos fluidos */\n  h1 { font-size: clamp(2.25rem, 5vw + 1rem, 3.5rem); }\n}\n\n/* ---------- UTILITIES PERSONALIZADAS ---------- */\n@layer utilities {\n  .text-balance { text-wrap: balance; }\n  .content-auto { content-visibility: auto; }\n  .scrollbar-none::-webkit-scrollbar { display: none; }\n\n  /* Animaciones on‑scroll */\n  .fade-in { opacity: 0; transform: translateY(20px) scale(0.98); transition: opacity 0.6s ease-out, transform 0.6s ease-out; }\n  .fade-in.visible { opacity: 1; transform: translateY(0) scale(1); }\n\n  /* Count‑up para stats */\n  .count-up { counter-reset: num var(--num); }\n  .count-up::after { content: counter(num); }\n  @keyframes count { from { --num: 0; } to { --num: var(--target); } }\n}\n\n/* 🆕------------------  MODO NOCHE GLOBAL  ------------------ */\n/* Estas reglas se aplican por igual a todos los componentes sin\n   tener que tocarlos uno por uno.  Se basan en utilidades Tailwind,\n   por lo que siguen pudiendo sobre‑escribirse con clases más\n   específicas cuando sea necesario. */\n@layer base {\n  /* Superficies claras → superficie oscura genérica */\n  .dark .bg-white,\n  .dark .bg-gray-50,\n  .dark .bg-gray-100 { @apply bg-gray-800; }\n\n  /* Fondo genérico utilizado en tarjetas (ItemCard, Skeleton…) */\n  .bg-surface       { background-color: var(--surface-light); }\n  .dark .bg-surface { background-color: var(--surface-dark); }\n\n  /* Bordes */\n  .dark .border-gray-200 { @apply border-gray-700; }\n  .dark .border-gray-300 { @apply border-gray-600; }\n\n  /* Texto neutro */\n  .dark .text-gray-500 { @apply text-gray-400; }\n  .dark .text-gray-600 { @apply text-gray-300; }\n  .dark .text-gray-700 { @apply text-gray-200; }\n\n  /* Sombreado de tarjetas más sutil en oscuro */\n  .dark .shadow-card     { box-shadow: 0 1px 3px rgba(0,0,0,.6); }\n  .dark .shadow-cardHover{ box-shadow: 0 4px 12px rgba(0,0,0,.8); }\n}\n\n/* Ajuste fino al ruido de fondo en oscuro */\n@media (prefers-color-scheme: dark) {\n  body { background-blend-mode: soft-light; }\n}\n",
    "frontend/src/features/auth/forgot.ts": "import { api } from \"../../api\";\n\n/**\n * Solicita el _reset_token_ para un usuario existente.\n * Devuelve el token si la operación fue correcta (404 si no existe).\n */\nexport async function forgot(username: string): Promise<string> {\n  const { data } = await api.post<{ reset_token: string }>(\n    \"/auth/password/forgot\",\n    { username }\n  );\n  return data.reset_token;\n}\n",
    "frontend/src/features/auth/register.ts": "import { api } from \"../../api\";\n\n/** Lanza 400 si el username o el email ya están en uso. */\nexport async function register(\n  username: string,\n  email: string,\n  password: string\n): Promise<void> {\n  await api.post(\"/auth/signup\", { username, email, password });\n}\n",
    "frontend/src/features/auth/login.ts": "import { api } from \"../../api\";\n\nexport async function login(username: string, password: string): Promise<string> {\n  const { data } = await api.post(\n    \"/auth/token\",\n    new URLSearchParams({ username, password }),\n    { headers: { \"Content-Type\": \"application/x-www-form-urlencoded\" } }\n  );\n  return data.access_token as string;\n}\n",
    "frontend/src/features/auth/reset.ts": "import { api } from \"../../api\";\n\n/**\n * Envía el nuevo password junto con el token recibido por “forgot”.\n * Lanza 400 si el token es inválido / expiró.\n */\nexport async function reset(token: string, newPassword: string): Promise<void> {\n  await api.post(\"/auth/password/reset\", { token, new_password: newPassword });\n}\n",
    "frontend/src/features/categories/useCategories.ts": "import { useQuery } from \"@tanstack/react-query\";\nimport { api } from \"../../api\";\n\nexport type Category = { id: number; name: string };\n\nexport default function useCategories() {\n  const { data, isLoading } = useQuery<Category[]>({\n    queryKey: [\"categories\"],\n    queryFn: () => api.get<Category[]>(\"/categories/\").then(r => r.data),\n    staleTime: 5 * 60_000 // 5 min\n  });\n\n  return { data: data ?? [], loading: isLoading };\n}\n",
    "frontend/src/features/items/useItems.ts": "import { useQuery } from '@tanstack/react-query';\nimport { api } from '../../api';\nimport type { Item } from './types';\n\n/**\n * Hook que devuelve la lista pública de ítems.\n * Acepta los mismos parámetros de querystring que la API (name, min_price…).\n */\nexport function useItems(params?: URLSearchParams) {\n  const queryKey = ['items', params?.toString() ?? ''];\n\n  const { data, isLoading, refetch } = useQuery<Item[]>({\n    queryKey,\n    queryFn: () =>\n      api.get<Item[]>('/items/', { params }).then(r => r.data),\n    staleTime: 60_000 // 1 min\n  });\n\n  return { data: data ?? [], loading: isLoading, refetch };\n}\n\n/* Reexportamos el tipo para mantener compatibilidad con imports existentes */\nexport type { Item };\n",
    "frontend/src/features/items/ItemList.tsx": "import { useEffect, useMemo, useRef, useState } from 'react';\nimport axios from 'axios';\nimport Container from '../../components/shared/Container';\nimport ItemCard from '../../components/ui/ItemCard';\nimport SkeletonCard from '../../components/ui/SkeletonCard';\nimport FiltersSidebar from '../../components/filters/FiltersSidebar';\nimport { useItems } from './useItems';\nimport { useAuth } from '../../hooks/useAuth';\nimport AddItemModal from './add-product-modal/AddProductModal';\nimport { Bars3Icon, XMarkIcon } from '@heroicons/react/24/outline';\n\n\n/* -------------------------------------------------- */\n/*                    Tipado filtros                  */\n/* -------------------------------------------------- */\ntype FiltersT = {\n  name?: string;\n  min_price?: number;\n  max_price?: number;\n  categories?: number[];\n  order?: 'price_asc' | 'price_desc' | 'name';\n};\n\nexport default function ItemList() {\n  /* ------------------------------ filtros ------------------------------ */\n  const [filters, setFilters] = useState<FiltersT>({});\n\n  /* Serializamos filtros → query-string */\n  const params = useMemo(() => {\n    const p = new URLSearchParams();\n\n    Object.entries(filters).forEach(([k, v]) => {\n      if (v === undefined || v === '') return;\n      if (Array.isArray(v)) v.forEach(val => p.append(k, String(val)));\n      else p.set(k, String(v));\n    });\n\n    /* orden (price_asc | price_desc | name) */\n    if (filters.order) {\n      const [field, dir] = filters.order.split('_');\n      p.set('order_by', field === 'price' ? 'price' : 'name');\n      p.set('order_dir', dir);\n    }\n    return p;\n  }, [filters]);\n\n  const { data: items, loading, refetch } = useItems(params);\n  const { token } = useAuth();\n\n  /* ----------------------- drawer móvil filtros ----------------------- */\n  const [openFilters, setOpenFilters] = useState(false);\n\n  /* ------------------------ infinite-scroll demo ---------------------- */\n  const sentinel = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    if (!sentinel.current) return;\n    const ob = new IntersectionObserver(\n      entries => {\n        if (entries[0].isIntersecting && !loading) {\n          /* Aquí podrías paginar → aumentar offset y refetch() */\n        }\n      },\n      { rootMargin: '600px' }\n    );\n    ob.observe(sentinel.current);\n    return () => ob.disconnect();\n  }, [loading]);\n\n  /* ----------------------- modal “añadir ítem” ------------------------ */\n  const [addOpen, setAddOpen] = useState(false);\n\n  /* -------------------------------------------------------------------- */\n  return (\n    <Container>\n      {/* ---------- botón abrir filtros (solo xs-sm) ---------- */}\n      <button onClick={() => setOpenFilters(true)} className=\"btn mb-4 md:hidden\">\n        <Bars3Icon className=\"mr-2 h-5 w-5\" />\n        Filtros\n      </button>\n\n      <div className=\"flex flex-col gap-10 md:flex-row\">\n        {/* ---------- Filtros (off-canvas en móvil) ---------- */}\n        {/* Backdrop */}\n        <div\n          className={`\n            fixed inset-0 z-40 bg-black/40 backdrop-blur-sm transition-opacity md:hidden\n            ${openFilters ? 'opacity-100 pointer-events-auto' : 'opacity-0 pointer-events-none'}\n          `}\n          onClick={() => setOpenFilters(false)}\n        />\n\n        {/* Panel */}\n        <aside\n          className={`\n            fixed left-0 top-0 z-50 h-full w-72 bg-white p-6 shadow-xl transition-transform\n            md:static md:h-auto md:w-auto md:translate-x-0 md:bg-transparent md:shadow-none\n            ${openFilters ? 'translate-x-0' : '-translate-x-full'}\n          `}\n        >\n          {/* Cerrar (solo móvil) */}\n          <button onClick={() => setOpenFilters(false)} className=\"mb-4 md:hidden\">\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n\n          <FiltersSidebar\n            value={filters}\n            onChange={setFilters}\n            onReset={() => setFilters({})}\n          />\n        </aside>\n\n        {/* -------------------- listado de tarjetas -------------------- */}\n        <section className=\"flex-1\">\n          {/* CTA añadir producto (solo usuarios logueados) */}\n          {token && (\n            <div className=\"flex justify-end\">\n              <button className=\"btn mb-4\" onClick={() => setAddOpen(true)}>\n                Añadir producto\n              </button>\n            </div>\n          )}\n\n          {/* loader inicial */}\n          {loading && !items.length ? (\n            <GridSkeleton />\n          ) : (\n            <Grid>\n              {items.map(it => (\n                <ItemCard key={it.id} item={it} />\n              ))}\n              {/* sentinel infinite-scroll */}\n              <div ref={sentinel} />\n            </Grid>\n          )}\n\n          {/* vacío */}\n          {!loading && !items.length && (\n            <p className=\"py-6 text-center text-gray-500\">No hay resultados.</p>\n          )}\n        </section>\n      </div>\n\n      {/* modal añadir */}\n      <AddItemModal open={addOpen} onClose={() => setAddOpen(false)} onCreated={refetch} />\n    </Container>\n  );\n}\n\n/* -------------------------------------------------- */\n/*                       Helpers                      */\n/* -------------------------------------------------- */\n\n/* Grid responsive: min-width 12 rem (≈192 px) y se\n   auto-ajusta con container-queries si el padre pasa\n   a ser un “container” — funciona también sin CQ. */\nconst Grid = ({ children }: { children: React.ReactNode }) => (\n  <div\n    className=\"\n      grid gap-6 py-6 content-auto\n      @container lg:[grid-template-columns:repeat(auto-fill,minmax(14rem,1fr))]\n      [grid-template-columns:repeat(auto-fill,minmax(12rem,1fr))]\n    \"\n  >\n    {children}\n  </div>\n);\n\nconst GridSkeleton = () => (\n  <Grid>\n    {Array.from({ length: 8 }).map((_, i) => (\n      <SkeletonCard key={i} />\n    ))}\n  </Grid>\n);\n",
    "frontend/src/features/items/types.ts": "/**\n * Modelos de dominio compartidos por todo el feature “items”.\n * Se ajustan 1‑a‑1 a la respuesta JSON del micro‑servicio Catálogo.\n */\n\nexport type Category = {\n  id: number;\n  name: string;\n};\n\n/* ---- listado (GET /items/) ------------------------------------------ */\nexport interface Item {\n  id: number;\n  name: string;\n  description?: string;\n  price_per_h: number;\n  available: boolean;\n\n  /* imágenes */\n  image_url?: string;   // compat. legacy\n  image_urls: string[]; // nuevas\n\n  categories: Category[];\n}\n\n/* ---- detalle (GET /items/{id}) -------------------------------------- */\nexport interface ItemDetail extends Item {\n  compare_at_price?: number | null;\n  sku?: string | null;\n  stock: number;\n  weight_kg?: number | null;\n  shipping_type: 'free' | 'local_pickup' | 'paid';\n  condition: 'new' | 'used';\n  hashtags: string[];\n  owner_username: string;\n}\n",
    "frontend/src/features/items/add-product-modal/ModalShell.tsx": "import { Fragment, PropsWithChildren } from 'react';\nimport { Dialog, Transition } from '@headlessui/react';\nimport { XMarkIcon } from '@heroicons/react/24/outline';\n\ntype Props = PropsWithChildren<{\n  open: boolean;\n  title: string;\n  onClose(): void;\n}>;\n\nexport default function ModalShell({ open, title, onClose, children }: Props) {\n  return (\n    <Transition show={open} as={Fragment}>\n      <Dialog onClose={onClose} className=\"relative z-50\">\n        <Transition.Child\n          as={Fragment}\n          enter=\"ease-out duration-300\"\n          enterFrom=\"opacity-0\"\n          enterTo=\"opacity-100\"\n          leave=\"ease-in duration-200\"\n          leaveFrom=\"opacity-100\"\n          leaveTo=\"opacity-0\"\n        >\n          <div className=\"fixed inset-0 bg-black/50 backdrop-blur-md dark:bg-black/70\" />\n        </Transition.Child>\n\n        <div className=\"fixed inset-0 grid place-items-center p-4 sm:p-6\">\n          <Transition.Child\n            as={Fragment}\n            enter=\"ease-out duration-300\"\n            enterFrom=\"scale-95 opacity-0\"\n            enterTo=\"scale-100 opacity-100\"\n            leave=\"ease-in duration-200\"\n            leaveFrom=\"scale-100 opacity-100\"\n            leaveTo=\"scale-95 opacity-0\"\n          >\n            <Dialog.Panel className=\"flex w-full max-w-lg sm:max-w-3xl max-h-[90vh] flex-col overflow-hidden rounded-2xl bg-white shadow-2xl dark:bg-gray-800 dark:shadow-gray-900 transition-all\">\n              <header className=\"flex items-center justify-between border-b border-gray-200 px-6 py-4 dark:border-gray-700\">\n                <Dialog.Title className=\"text-xl font-semibold text-gray-900 dark:text-gray-100\">\n                  {title}\n                </Dialog.Title>\n                <button\n                  type=\"button\"\n                  className=\"rounded-lg p-2 text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-brand dark:text-gray-400 dark:hover:bg-gray-700\"\n                  onClick={onClose}\n                >\n                  <XMarkIcon className=\"h-6 w-6\" />\n                </button>\n              </header>\n\n              {children}\n            </Dialog.Panel>\n          </Transition.Child>\n        </div>\n      </Dialog>\n    </Transition>\n  );\n}\n",
    "frontend/src/features/items/add-product-modal/AddProductModal.tsx": "import { FormProvider, useForm } from 'react-hook-form';\nimport { zodResolver } from '@hookform/resolvers/zod';\nimport toast from 'react-hot-toast';\nimport { ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { Fragment } from 'react';\n\nimport { addProductSchema, AddProductFormData } from './schema';\nimport ModalShell from './ModalShell';\nimport BasicInfoSection from './sections/BasicInfoSection';\nimport MediaSection from './sections/MediaSection';\nimport PricingSection from './sections/PricingSection';\nimport InventorySection from './sections/InventorySection';\nimport ShippingSection from './sections/ShippingSection';\n\nimport { api } from '../../../api';\nimport { useAuth } from '../../../hooks/useAuth';\n\ntype Props = {\n  open: boolean;\n  onClose(): void;\n  onCreated(): void;\n};\n\nexport default function AddProductModal({ open, onClose, onCreated }: Props) {\n  const { token } = useAuth();\n\n  const methods = useForm<AddProductFormData>({\n    resolver: zodResolver(addProductSchema),\n    defaultValues: {\n      categories: [],\n      images: [],\n      condition: 'new',\n      hashtags: [],\n      stock: 1,\n      shipping_type: 'free'\n    }\n  });\n\nasync function onSubmit(data: AddProductFormData) {\n  if (!token) {\n    toast.error('Debes haber iniciado sesión');\n    return;\n  }\n\n  try {\n    /* 1. Subir imágenes */\n    let image_urls: string[] = [];\n    if (data.images.length) {\n      const uploads = await Promise.all(\n        data.images.map(async img => {\n          const fd = new FormData();\n          fd.append('file', img);\n          const r = await api.post<{ url: string }>('/upload/', fd, {\n            headers: { 'Content-Type': 'multipart/form-data' }\n          });\n          return r.data.url;\n        })\n      );\n      image_urls = uploads;\n    }\n\n    /* 2. Construir payload coherente con la API */\n    const payload = {\n      name: data.name,\n      description: data.description,\n      price_per_h: data.price,           // 👈 se mapea\n      compare_at_price: data.compare_at_price || undefined,\n      categories: data.categories.length ? data.categories : undefined,\n      image_urls,\n      sku: data.sku || undefined,\n      stock: data.stock,\n      weight_kg: data.weight_kg,\n      shipping_type: data.shipping_type,\n      condition: data.condition,\n      hashtags: data.hashtags.filter(Boolean)     // quita strings vacíos\n    };\n\n    await api.post('/items/', payload);\n\n    toast.success('¡Producto publicado!');\n    methods.reset();\n    onCreated();\n    onClose();\n  } catch (err: any) {\n    console.error(err);\n    toast.error(err.response?.data?.detail ?? 'Error al crear producto');\n  }\n}\n\n  return (\n    <ModalShell\n      open={open}\n      title=\"Nuevo producto\"\n      onClose={() => {\n        methods.reset();\n        onClose();\n      }}\n    >\n      <FormProvider {...methods}>\n        <form\n          onSubmit={methods.handleSubmit(onSubmit)}\n          className=\"grid grid-cols-1 sm:grid-cols-2 gap-8 overflow-y-auto px-6 py-8\"\n        >\n          {/* Columna izquierda */}\n          <div className=\"space-y-10\">\n            <BasicInfoSection />\n            <MediaSection />\n          </div>\n\n          {/* Columna derecha */}\n          <div className=\"space-y-10\">\n            <PricingSection />\n            <InventorySection />\n            <ShippingSection />\n          </div>\n\n          {/* Footer */}\n          <div className=\"sm:col-span-2 flex justify-end gap-4 mt-6\">\n            <button\n              type=\"button\"\n              className=\"btn--ghost px-6 py-3 rounded-lg text-sm font-medium transition-all hover:shadow-md dark:hover:bg-gray-700\"\n              onClick={() => {\n                methods.reset();\n                onClose();\n              }}\n            >\n              Cancelar\n            </button>\n            <button\n              className=\"btn px-6 py-3 rounded-lg text-sm font-medium flex items-center justify-center\"\n              disabled={methods.formState.isSubmitting}\n            >\n              {methods.formState.isSubmitting ? (\n                <>\n                  <ArrowPathIcon className=\"mr-2 h-5 w-5 animate-spin\" />\n                  Publicando…\n                </>\n              ) : (\n                'Publicar'\n              )}\n            </button>\n          </div>\n        </form>\n      </FormProvider>\n    </ModalShell>\n  );\n}\n",
    "frontend/src/features/items/add-product-modal/schema.ts": "import { z } from 'zod';\n\nconst MB = 1024 * 1024;\nexport const MAX_IMAGES = 10;\n\nexport const priceRegex = /^\\d+([.,]\\d{1,2})?$/;\n\nexport const addProductSchema = z.object({\n  // Información básica\n  name: z.string().min(3, 'Mínimo 3 caracteres'),\n  description: z.string().max(500).optional(),\n  categories: z.array(z.number()).min(1, 'Selecciona al menos una categoría'),\n  condition: z.enum(['new', 'used']),\n  hashtags: z.array(z.string()).max(5, 'Máx. 5 hashtags'),\n\n  // Media\n  images: z\n    .array(\n      z\n        .instanceof(File)\n        .refine(f => f.size <= 5 * MB, 'Cada imagen máx. 5 MB')\n    )\n    .min(1, 'Al menos 1 imagen')\n    .max(MAX_IMAGES, `Máx. ${MAX_IMAGES} imágenes`),\n\n  // Pricing\n  price: z\n    .string()\n    .regex(priceRegex, 'Precio inválido')\n    .transform(v => Number(v.replace(',', '.'))),\n  compare_at_price: z\n    .string()\n    .regex(priceRegex, 'Precio inválido')\n    .transform(v => (v ? Number(v.replace(',', '.')) : undefined))\n    .optional(),\n\n  // Inventory\n  sku: z.string().max(40).optional(),\n  stock: z.number().int().min(0).default(1),\n\n  // Shipping\n  weight_kg: z\n    .string()\n    .regex(priceRegex, 'Número inválido')\n    .transform(v => Number(v.replace(',', '.'))),\n  shipping_type: z.enum(['free', 'local_pickup', 'paid'])\n});\n\nexport type AddProductFormData = z.infer<typeof addProductSchema>;\n",
    "frontend/src/features/items/add-product-modal/hooks/useImagePreviews.ts": "import { useEffect, useState } from 'react';\n\nexport default function useImagePreviews(files: File[]) {\n  const [previews, setPreviews] = useState<string[]>([]);\n\n  useEffect(() => {\n    if (!files.length) {\n      setPreviews([]);\n      return;\n    }\n    const urls = files.map(f => URL.createObjectURL(f));\n    setPreviews(urls);\n    return () => urls.forEach(URL.revokeObjectURL);\n  }, [files]);\n\n  return previews;\n}\n",
    "frontend/src/features/items/add-product-modal/sections/ShippingSection.tsx": "import { useFormContext } from 'react-hook-form';\n\nexport default function ShippingSection() {\n  const { register, formState: { errors } } = useFormContext();\n\n  return (\n    <section className=\"space-y-6\">\n      {/* Peso */}\n      <div className=\"relative\">\n        <input\n          {...register('weight_kg')}\n          id=\"weight\"\n          placeholder=\"Peso (kg)\"\n          inputMode=\"decimal\"\n          className=\"peer form-input w-full rounded-lg border-gray-300 placeholder-transparent focus:border-brand focus:ring-brand dark:border-gray-600 dark:bg-gray-700 dark:focus:border-brand\"\n        />\n        <label\n          htmlFor=\"weight\"\n          className=\"form-floating-label peer-placeholder-shown:form-floating-label--placeholder dark:bg-gray-800\"\n        >\n          Peso (kg)\n        </label>\n        {errors.weight_kg && <p className=\"form-error\">{errors.weight_kg.message}</p>}\n      </div>\n\n      {/* Tipo envío */}\n      <div>\n        <label className=\"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-300\">\n          Tipo de envío\n        </label>\n        <select\n          {...register('shipping_type')}\n          className=\"form-select w-full rounded-lg border-gray-300 focus:border-brand focus:ring-brand dark:border-gray-600 dark:bg-gray-700\"\n        >\n          <option value=\"free\">Envío gratis</option>\n          <option value=\"local_pickup\">Recogida local</option>\n          <option value=\"paid\">Envío pagado</option>\n        </select>\n        {errors.shipping_type && <p className=\"form-error\">{errors.shipping_type.message}</p>}\n      </div>\n    </section>\n  );\n}\n",
    "frontend/src/features/items/add-product-modal/sections/MediaSection.tsx": "import { PhotoIcon, TrashIcon } from '@heroicons/react/24/outline';\nimport { useFormContext } from 'react-hook-form';\nimport { MAX_IMAGES } from '../schema';\nimport useImagePreviews from '../hooks/useImagePreviews';\n\nexport default function MediaSection() {\n  const { watch, setValue, formState: { errors } } = useFormContext();\n  const files: File[] = watch('images') || [];\n  const previews = useImagePreviews(files);\n\n  return (\n    <section className=\"space-y-4\">\n      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n        Imágenes ({files.length}/{MAX_IMAGES})\n      </label>\n\n      {/* Zona de drop */}\n      <label className=\"drop-zone\">\n        <PhotoIcon className=\"h-10 w-10 mb-2\" />\n        <span className=\"font-medium\">Haz clic o arrastra archivos aquí</span>\n        <span className=\"text-xs mt-1\">PNG/JPG · máx. 5 MB · hasta {MAX_IMAGES}</span>\n        <input\n          type=\"file\"\n          accept=\"image/*\"\n          multiple\n          className=\"sr-only\"\n          onChange={e =>\n            setValue('images', [...(e.target.files ?? [])] as File[], { shouldValidate: true })\n          }\n        />\n      </label>\n\n      {/* Previews */}\n      {!!previews.length && (\n        <div className=\"grid grid-cols-2 sm:grid-cols-3 gap-3\">\n          {previews.map((src, i) => (\n            <div key={i} className=\"relative group\">\n              <img\n                src={src}\n                alt={`preview-${i}`}\n                className=\"h-28 w-full rounded-lg object-cover transition-transform group-hover:scale-105\"\n              />\n              <button\n                type=\"button\"\n                title=\"Eliminar\"\n                onClick={() => {\n                  const copy = [...files];\n                  copy.splice(i, 1);\n                  setValue('images', copy, { shouldValidate: true });\n                }}\n                className=\"absolute inset-0 flex items-center justify-center bg-black/50 opacity-0 transition-opacity group-hover:opacity-100\"\n              >\n                <TrashIcon className=\"h-8 w-8 text-white\" />\n              </button>\n            </div>\n          ))}\n        </div>\n      )}\n\n      {errors.images && <p className=\"form-error\">{errors.images.message as string}</p>}\n    </section>\n  );\n}\n",
    "frontend/src/features/items/add-product-modal/sections/BasicInfoSection.tsx": "import { useFormContext } from 'react-hook-form';\nimport Chip from '../components/Chip';\nimport useCategories, { Category } from '../../../categories/useCategories';\n\nexport default function BasicInfoSection() {\n  const { data: cats } = useCategories();\n  const {\n    register,\n    watch,\n    setValue,\n    formState: { errors }\n  } = useFormContext();\n\n  return (\n    <section className=\"space-y-6\">\n      {/* Nombre */}\n      <div className=\"relative\">\n        <input\n          {...register('name')}\n          id=\"name\"\n          placeholder=\"Nombre del producto\"\n          className=\"peer form-input w-full rounded-lg border-gray-300 placeholder-transparent focus:border-brand focus:ring-brand dark:border-gray-600 dark:bg-gray-700 dark:focus:border-brand\"\n        />\n        <label\n          htmlFor=\"name\"\n          className=\"form-floating-label peer-placeholder-shown:form-floating-label--placeholder dark:bg-gray-800\"\n        >\n          Nombre\n        </label>\n        {errors.name && <p className=\"form-error\">{errors.name.message}</p>}\n      </div>\n\n      {/* Descripción */}\n      <div className=\"relative\">\n        <textarea\n          {...register('description')}\n          id=\"description\"\n          rows={4}\n          placeholder=\"Descripción detallada\"\n          className=\"peer form-input w-full resize-y rounded-lg border-gray-300 placeholder-transparent focus:border-brand focus:ring-brand dark:border-gray-600 dark:bg-gray-700 dark:focus:border-brand\"\n        />\n        <label\n          htmlFor=\"description\"\n          className=\"form-floating-label peer-placeholder-shown:form-floating-label--placeholder dark:bg-gray-800\"\n        >\n          Descripción\n        </label>\n        <span className=\"absolute bottom-2 right-3 text-xs text-gray-400\">\n          {watch('description')?.length ?? 0}/500\n        </span>\n        {errors.description && <p className=\"form-error\">{errors.description.message}</p>}\n      </div>\n\n      {/* Categorías */}\n      <div>\n        <p className=\"mb-2 text-sm font-medium text-gray-700 dark:text-gray-300\">Categorías</p>\n        <div className=\"flex flex-wrap gap-2\">\n          {cats.map((c: Category) => {\n            const selected = watch('categories').includes(c.id);\n            return (\n              <Chip\n                key={c.id}\n                selected={selected}\n                onClick={() => {\n                  const current = new Set(watch('categories'));\n                  selected ? current.delete(c.id) : current.add(c.id);\n                  setValue('categories', [...current]);\n                }}\n              >\n                {c.name}\n              </Chip>\n            );\n          })}\n        </div>\n        {errors.categories && <p className=\"form-error\">{errors.categories.message}</p>}\n      </div>\n\n      {/* Estado */}\n      <div>\n        <label className=\"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-300\">\n          Estado\n        </label>\n        <select\n          {...register('condition')}\n          className=\"form-select w-full rounded-lg border-gray-300 focus:border-brand focus:ring-brand dark:border-gray-600 dark:bg-gray-700\"\n        >\n          <option value=\"new\">Nuevo</option>\n          <option value=\"used\">Usado</option>\n        </select>\n        {errors.condition && <p className=\"form-error\">{errors.condition.message}</p>}\n      </div>\n    </section>\n  );\n}\n",
    "frontend/src/features/items/add-product-modal/sections/PricingSection.tsx": "import { useFormContext } from 'react-hook-form';\n\nexport default function PricingSection() {\n  const { register, formState: { errors } } = useFormContext();\n\n  return (\n    <section className=\"space-y-6\">\n      {/* Precio */}\n      <div className=\"relative\">\n        <input\n          {...register('price')}\n          id=\"price\"\n          placeholder=\"Precio\"\n          inputMode=\"decimal\"\n          className=\"peer form-input w-full rounded-lg border-gray-300 pl-8 placeholder-transparent focus:border-brand focus:ring-brand dark:border-gray-600 dark:bg-gray-700 dark:focus:border-brand\"\n        />\n        <span className=\"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 dark:text-gray-400\">\n          €\n        </span>\n        <label\n          htmlFor=\"price\"\n          className=\"form-floating-label peer-placeholder-shown:form-floating-label--placeholder dark:bg-gray-800\"\n        >\n          Precio\n        </label>\n        {errors.price && <p className=\"form-error\">{errors.price.message}</p>}\n      </div>\n\n      {/* Precio comparado */}\n      <div className=\"relative\">\n        <input\n          {...register('compare_at_price')}\n          id=\"compare\"\n          placeholder=\"Precio anterior (opcional)\"\n          inputMode=\"decimal\"\n          className=\"peer form-input w-full rounded-lg border-gray-300 pl-8 placeholder-transparent focus:border-brand focus:ring-brand dark:border-gray-600 dark:bg-gray-700 dark:focus:border-brand\"\n        />\n        <span className=\"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 dark:text-gray-400\">\n          €\n        </span>\n        <label\n          htmlFor=\"compare\"\n          className=\"form-floating-label peer-placeholder-shown:form-floating-label--placeholder dark:bg-gray-800\"\n        >\n          Precio anterior\n        </label>\n        {errors.compare_at_price && <p className=\"form-error\">{errors.compare_at_price.message}</p>}\n      </div>\n    </section>\n  );\n}\n",
    "frontend/src/features/items/add-product-modal/sections/InventorySection.tsx": "import { useFormContext } from 'react-hook-form';\n\nexport default function InventorySection() {\n  const { register, formState: { errors } } = useFormContext();\n\n  return (\n    <section className=\"space-y-6\">\n      {/* SKU */}\n      <div className=\"relative\">\n        <input\n          {...register('sku')}\n          id=\"sku\"\n          placeholder=\"SKU (opcional)\"\n          className=\"peer form-input w-full rounded-lg border-gray-300 placeholder-transparent focus:border-brand focus:ring-brand dark:border-gray-600 dark:bg-gray-700 dark:focus:border-brand\"\n        />\n        <label\n          htmlFor=\"sku\"\n          className=\"form-floating-label peer-placeholder-shown:form-floating-label--placeholder dark:bg-gray-800\"\n        >\n          SKU\n        </label>\n        {errors.sku && <p className=\"form-error\">{errors.sku.message}</p>}\n      </div>\n\n      {/* Stock */}\n      <div className=\"relative\">\n        <input\n          {...register('stock', { valueAsNumber: true })}\n          id=\"stock\"\n          placeholder=\"Stock disponible\"\n          type=\"number\"\n          min={0}\n          className=\"peer form-input w-full rounded-lg border-gray-300 placeholder-transparent focus:border-brand focus:ring-brand dark:border-gray-600 dark:bg-gray-700 dark:focus:border-brand\"\n        />\n        <label\n          htmlFor=\"stock\"\n          className=\"form-floating-label peer-placeholder-shown:form-floating-label--placeholder dark:bg-gray-800\"\n        >\n          Stock\n        </label>\n        {errors.stock && <p className=\"form-error\">{errors.stock.message}</p>}\n      </div>\n    </section>\n  );\n}\n",
    "frontend/src/features/items/add-product-modal/components/Chip.tsx": "import clsx from 'clsx';\nimport { PropsWithChildren } from 'react';\n\ntype Props = PropsWithChildren<{\n  selected?: boolean;\n  onClick: () => void;\n}>;\n\nexport default function Chip({ selected, onClick, children }: Props) {\n  return (\n    <button\n      type=\"button\"\n      onClick={onClick}\n      className={clsx(\n        'rounded-full px-4 py-1 text-sm font-medium transition-all',\n        selected\n          ? 'bg-brand text-white shadow-md hover:shadow-lg'\n          : 'bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600'\n      )}\n    >\n      {children}\n    </button>\n  );\n}\n",
    "frontend/src/features/items/item-detail/ItemDetailModal.tsx": "import { Fragment } from 'react';\nimport { Dialog, Transition } from '@headlessui/react';\nimport { XMarkIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\n\nimport useItem from './hooks/useItem';\nimport ModalShell from '../add-product-modal/ModalShell';\nimport Skeleton from './components/Skeleton';\nimport ImageGallery from './components/ImageGallery';\nimport PriceBlock from './components/PriceBlock';\nimport CategoryChips from './components/CategoryChips';\nimport HashtagList from './components/HashtagList';\nimport InfoGrid from './components/InfoGrid';\nimport OwnerBanner from './components/OwnerBanner';\n\ntype Props = {\n  open: boolean;\n  itemId: number | null;\n  onClose(): void;\n};\n\nexport default function ItemDetailModal({ open, itemId, onClose }: Props) {\n  const { data, isLoading } = useItem(itemId);\n\n  return (\n    <ModalShell open={open} title={data?.name ?? 'Cargando…'} onClose={onClose}>\n      <div className=\"p-6 overflow-y-auto max-h-[90vh]\">\n        {isLoading || !data ? (\n          <Skeleton />\n        ) : (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\n            {/* Galería */}\n            <ImageGallery urls={data.image_urls} />\n\n            {/* Columna derecha */}\n            <div className=\"space-y-6\">\n              <PriceBlock\n                price={data.price_per_h}\n                compare={data.compare_at_price}\n                stock={data.stock}\n              />\n\n              <CategoryChips cats={data.categories} />\n              <HashtagList tags={data.hashtags} />\n\n              <p className=\"prose max-w-none dark:prose-invert\">{data.description}</p>\n\n              <InfoGrid item={data} />\n\n              <OwnerBanner owner={data.owner_username} />\n\n              <button className=\"btn w-full md:w-auto\">Contactar vendedor</button>\n            </div>\n          </div>\n        )}\n      </div>\n    </ModalShell>\n  );\n}\n",
    "frontend/src/features/items/item-detail/ProductDetailModal.tsx": "import { Fragment } from 'react';\nimport { Dialog, Transition } from '@headlessui/react';\nimport {\n  XMarkIcon,\n  ArrowPathIcon,\n  HeartIcon,\n  ShareIcon,\n} from '@heroicons/react/24/outline';\nimport clsx from 'clsx';\n\nimport ImageGallery from './components/ImageGallery';\nimport PriceBlock from './components/PriceBlock';\nimport InfoGrid from './components/InfoGrid';\nimport CategoryChips from './components/CategoryChips';\nimport HashtagList from './components/HashtagList';\nimport OwnerBanner from './components/OwnerBanner';\nimport useItem from './hooks/useItem';\nimport { useAuth } from '../../../hooks/useAuth';\n\ntype Props = {\n  itemId: number | null;\n  open: boolean;\n  onClose(): void;\n};\n\nexport default function ProductDetailModal({ itemId, open, onClose }: Props) {\n  const { data, isLoading } = useItem(itemId);\n  const { token } = useAuth();\n\n  /* ---------- placeholder mientras carga ---------- */\n  if (isLoading || !data) {\n    return (\n      <SkeletonShell open={open} onClose={onClose} />\n    );\n  }\n\n  return (\n    <Transition show={open} as={Fragment}>\n      <Dialog\n        onClose={onClose}\n        className=\"fixed inset-0 z-50 overflow-y-auto p-4 sm:p-6 lg:p-10\"\n      >\n        {/* BACKDROP */}\n        <Transition.Child\n          as={Fragment}\n          enter=\"ease-out duration-200\"\n          enterFrom=\"opacity-0\"\n          enterTo=\"opacity-100\"\n          leave=\"ease-in duration-150\"\n          leaveFrom=\"opacity-100\"\n          leaveTo=\"opacity-0\"\n        >\n          <div className=\"absolute inset-0 bg-black/50 backdrop-blur-sm\" />\n        </Transition.Child>\n\n        {/* PANEL */}\n        <div className=\"relative mx-auto flex w-full max-w-5xl\">\n          <Transition.Child\n            as={Fragment}\n            enter=\"ease-out duration-200\"\n            enterFrom=\"translate-y-8 sm:translate-y-0 sm:scale-95 opacity-0\"\n            enterTo=\"translate-y-0 sm:scale-100 opacity-100\"\n            leave=\"ease-in duration-150\"\n            leaveFrom=\"translate-y-0 sm:scale-100 opacity-100\"\n            leaveTo=\"translate-y-8 sm:translate-y-0 sm:scale-95 opacity-0\"\n          >\n            <Dialog.Panel className=\"relative grid w-full overflow-hidden rounded-3xl bg-white shadow-2xl dark:bg-gray-800 md:grid-cols-2\">\n              {/* ---------- GALERÍA ---------- */}\n              <ImageGallery urls={data.image_urls} />\n\n              {/* ---------- INFO ---------- */}\n              <div className=\"flex flex-col gap-6 p-6 md:p-10\">\n                {/* header móvil */}\n                <div className=\"flex items-start justify-between md:hidden\">\n                  <h2 className=\"text-xl font-semibold\">{data.name}</h2>\n                  <CloseBtn onClose={onClose} />\n                </div>\n\n                {/* breadcrumb opcional */}\n                <CategoryChips cats={data.categories} />\n\n                {/* nombre + acciones */}\n                <div className=\"flex items-start justify-between\">\n                  <h1 className=\"hidden text-2xl font-bold md:block\">\n                    {data.name}\n                  </h1>\n\n                  {/* acciones like / share (solo usuarios) */}\n                  {token && (\n                    <div className=\"flex gap-2\">\n                      <IconBtn title=\"Favorito\">\n                        <HeartIcon className=\"h-5 w-5\" />\n                      </IconBtn>\n                      <IconBtn title=\"Compartir\">\n                        <ShareIcon className=\"h-5 w-5\" />\n                      </IconBtn>\n                    </div>\n                  )}\n                </div>\n\n                {/* price + stock */}\n                <PriceBlock\n                  price={data.price_per_h}\n                  compare={data.compare_at_price}\n                  stock={data.stock}\n                />\n\n                {/* descripción */}\n                {!!data.description && (\n                  <p className=\"prose max-w-none text-gray-700 dark:prose-invert\">\n                    {data.description}\n                  </p>\n                )}\n\n                {/* hashtags */}\n                <HashtagList tags={data.hashtags} />\n\n                {/* tabla atributos */}\n                <InfoGrid item={data} />\n\n                {/* banner propietario */}\n                <OwnerBanner owner={data.owner_username} />\n\n                {/* CTA reservar / contactar */}\n                <div className=\"mt-auto flex flex-col gap-3 sm:flex-row\">\n                  <button className=\"btn flex-1\">Reservar ahora</button>\n                  <button className=\"btn--ghost flex-1\">Contactar</button>\n                </div>\n              </div>\n            </Dialog.Panel>\n          </Transition.Child>\n        </div>\n      </Dialog>\n    </Transition>\n  );\n}\n\n/* ---------- Helpers ---------- */\n\nfunction SkeletonShell({ open, onClose }: { open: boolean; onClose(): void }) {\n  return (\n    <Transition show={open} as={Fragment}>\n      <Dialog onClose={onClose} className=\"fixed inset-0 z-50 grid place-items-center p-4\">\n        <div className=\"absolute inset-0 bg-black/40 backdrop-blur-sm\" />\n        <div className=\"h-[70vh] w-full max-w-5xl animate-pulse rounded-3xl bg-white/70 dark:bg-gray-700/70\" />\n      </Dialog>\n    </Transition>\n  );\n}\n\nfunction CloseBtn({ onClose }: { onClose(): void }) {\n  return (\n    <button\n      onClick={onClose}\n      className=\"rounded-full p-2 text-gray-500 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700\"\n      aria-label=\"Cerrar\"\n    >\n      <XMarkIcon className=\"h-6 w-6\" />\n    </button>\n  );\n}\n\nfunction IconBtn({\n  children,\n  title,\n}: {\n  children: React.ReactNode;\n  title: string;\n}) {\n  return (\n    <button\n      type=\"button\"\n      title={title}\n      className=\"rounded-full border p-2 text-gray-500 hover:bg-gray-100 dark:border-gray-600 dark:hover:bg-gray-700\"\n    >\n      {children}\n    </button>\n  );\n}\n",
    "frontend/src/features/items/item-detail/hooks/useItem.ts": "import { useQuery } from '@tanstack/react-query';\nimport { api } from '../../../../api';\nimport type { ItemDetail } from '../../types';\n\n/**\n * Obtiene los datos completos de un ítem por ID.\n * Se usa dentro del modal de detalle.\n */\nexport default function useItem(itemId: number | null) {\n  return useQuery<ItemDetail>({\n    queryKey: ['item', itemId],\n    enabled: !!itemId,\n    queryFn: () => api.get<ItemDetail>(`/items/${itemId}`).then(r => r.data),\n    staleTime: 60_000\n  });\n}\n",
    "frontend/src/features/items/item-detail/components/StockBadge.tsx": "type Props = { stock: number };\n\nexport default function StockBadge({ stock }: Props) {\n  const color = stock === 0 ? 'bg-red-600' : stock < 5 ? 'bg-amber-500' : 'bg-emerald-600';\n  const label = stock === 0 ? 'Sin stock' : stock < 5 ? 'Quedan pocas unidades' : 'En stock';\n\n  return (\n    <span className={`inline-flex items-center rounded-full px-3 py-0.5 text-xs font-semibold text-white ${color}`}>\n      {label}\n    </span>\n  );\n}\n",
    "frontend/src/features/items/item-detail/components/CategoryChips.tsx": "import Chip from '../../add-product-modal/components/Chip';\n\ntype Cat = { id: number; name: string };\n\nexport default function CategoryChips({ cats }: { cats: Cat[] }) {\n  if (!cats.length) return null;\n  return (\n    <div className=\"flex flex-wrap gap-2\">\n      {cats.map(c => (\n        <Chip key={c.id} onClick={() => null}>\n          {c.name}\n        </Chip>\n      ))}\n    </div>\n  );\n}\n",
    "frontend/src/features/items/item-detail/components/OwnerBanner.tsx": "export default function OwnerBanner({ owner }: { owner: string }) {\n  return (\n    <p className=\"text-xs text-gray-500\">\n      Publicado por <span className=\"font-medium\">@{owner}</span>\n    </p>\n  );\n}\n",
    "frontend/src/features/items/item-detail/components/InfoGrid.tsx": "import type { ItemDetail } from '../../types';\n\nexport default function InfoGrid({ item }: { item: ItemDetail }) {\n  const rows = [\n    ['SKU', item.sku ?? '—'],\n    ['Peso (kg)', item.weight_kg?.toFixed(2) ?? '—'],\n    [\n      'Tipo de envío',\n      { free: 'Envío gratis', local_pickup: 'Recogida local', paid: 'Envío pagado' }[\n        item.shipping_type\n      ]\n    ],\n    ['Condición', item.condition === 'new' ? 'Nuevo' : 'Usado']\n  ];\n\n  return (\n    <table className=\"w-full text-sm text-gray-600 dark:text-gray-300\">\n      <tbody>\n        {rows.map(([k, v]) => (\n          <tr key={k as string} className=\"border-t border-gray-200 dark:border-gray-700\">\n            <th className=\"py-2 pr-4 font-medium text-gray-700 dark:text-gray-400\">{k}</th>\n            <td className=\"py-2\">{v}</td>\n          </tr>\n        ))}\n      </tbody>\n    </table>\n  );\n}\n",
    "frontend/src/features/items/item-detail/components/HashtagList.tsx": "export default function HashtagList({ tags }: { tags: string[] }) {\n  if (!tags.length) return null;\n  return (\n    <ul className=\"flex flex-wrap gap-2\">\n      {tags.map(t => (\n        <li key={t} className=\"text-sm text-sky-700 dark:text-sky-400\">#{t.replace(/^#/, '')}</li>\n      ))}\n    </ul>\n  );\n}\n",
    "frontend/src/features/items/item-detail/components/PriceBlock.tsx": "import StockBadge from './StockBadge';\n\ntype Props = {\n  price: number;\n  compare?: number | null;\n  stock: number;\n};\n\nexport default function PriceBlock({ price, compare, stock }: Props) {\n  const hasDiscount = compare && compare > price;\n  const discount = hasDiscount ? Math.round(((compare - price) / compare) * 100) : 0;\n\n  return (\n    <div className=\"space-y-2\">\n      <div className=\"flex items-baseline gap-2\">\n        <span className=\"text-3xl font-extrabold text-brand\">\n          €{price.toFixed(2)}\n        </span>\n        <span className=\"text-xs text-gray-500\">/ h</span>\n        {hasDiscount && (\n          <>\n            <span className=\"text-lg line-through text-gray-400\">\n              €{compare!.toFixed(2)}\n            </span>\n            <span className=\"badge badge--danger\">–{discount}%</span>\n          </>\n        )}\n      </div>\n      <StockBadge stock={stock} />\n    </div>\n  );\n}\n\n",
    "frontend/src/features/items/item-detail/components/Skeleton.tsx": "export default function Skeleton() {\n  return (\n    <div className=\"animate-pulse grid grid-cols-1 md:grid-cols-2 gap-8\">\n      <div className=\"h-80 bg-gray-200 dark:bg-gray-700 rounded-xl\" />\n      <div className=\"space-y-4\">\n        <div className=\"h-8 w-2/3 bg-gray-200 dark:bg-gray-700 rounded\" />\n        <div className=\"h-6 w-1/3 bg-gray-200 dark:bg-gray-700 rounded\" />\n        <div className=\"h-4 w-full bg-gray-200 dark:bg-gray-700 rounded\" />\n        <div className=\"h-4 w-5/6 bg-gray-200 dark:bg-gray-700 rounded\" />\n        <div className=\"h-10 w-32 bg-gray-200 dark:bg-gray-700 rounded\" />\n      </div>\n    </div>\n  );\n}\n",
    "frontend/src/features/items/item-detail/components/ImageGallery.tsx": "import { useState } from 'react';\nimport { useSwipeable } from 'react-swipeable';\nimport { ChevronLeftIcon, ChevronRightIcon } from '@heroicons/react/24/solid';\nimport clsx from 'clsx';\n\nexport default function ImageGallery({ urls }: { urls: string[] }) {\n  const [idx, setIdx] = useState(0);\n  const total = urls.length;\n\n  const handlers = useSwipeable({\n    onSwipedLeft: () => next(),\n    onSwipedRight: () => prev(),\n    trackMouse: true,\n  });\n\n  function next() {\n    setIdx((i) => (i + 1) % total);\n  }\n  function prev() {\n    setIdx((i) => (i - 1 + total) % total);\n  }\n\n  return (\n    <div {...handlers} className=\"flex flex-col gap-4 bg-gray-50 dark:bg-gray-700\">\n      {/* main */}\n        <div className=\"relative aspect-[4/3] w-full\">          {/* NUEVO: ratio 4:3 */}\n        <img\n            src={urls[idx]}\n            alt={`Imagen ${idx + 1}`}\n            className=\"absolute inset-0 h-full w-full\n                    object-contain rounded-xl\"             \n        />\n\n        {total > 1 && (\n          <>\n            <NavBtn pos=\"left\" onClick={prev} />\n            <NavBtn pos=\"right\" onClick={next} />\n          </>\n        )}\n      </div>\n\n      {/* thumbs */}\n      {total > 1 && (\n        <div className=\"flex gap-2 overflow-x-auto px-2 pb-2\">\n          {urls.map((u, i) => (\n            <button\n              key={i}\n              onClick={() => setIdx(i)}\n              aria-label={`Miniatura ${i + 1}`}\n              className={clsx(\n                'relative aspect-square h-16 overflow-hidden rounded-lg',\n                i === idx && 'ring-2 ring-brand'\n              )}\n            >\n              <img src={u} alt=\"\" className=\"h-full w-full object-cover\" />\n            </button>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n\nfunction NavBtn({\n  pos,\n  onClick,\n}: {\n  pos: 'left' | 'right';\n  onClick(): void;\n}) {\n  const Icon = pos === 'left' ? ChevronLeftIcon : ChevronRightIcon;\n  return (\n    <button\n      onClick={onClick}\n      className={clsx(\n        'group absolute top-1/2 -translate-y-1/2 rounded-full bg-black/40 p-2 text-white',\n        pos === 'left' ? 'left-2' : 'right-2'\n      )}\n    >\n      <Icon className=\"h-6 w-6 group-hover:scale-110 transition-transform\" />\n    </button>\n  );\n}\n",
    "frontend/src/features/rentals/reserve.ts": "/**\n * Orquesta todo el flujo:\n *   1) crea un alquiler              → /api/rentals/\n *   2) pide PaymentIntent a Stripe   → /api/payments/create-intent\n * Devuelve el `client_secret` para confirmar el pago desde el front.\n */\nimport { api } from \"../../api\";\n\n// ### UPDATED: Acepta fechas reales\nexport async function reserve(item_id: number, start: Date, end: Date) {\n  const start_at = start.toISOString();\n  const end_at = end.toISOString();\n\n  // 1) crear alquiler con fechas\n  const { data: rental } = await api.post(\"/rentals/\", {\n    item_id,\n    start_at,\n    end_at\n  });\n\n  // 2) crear PaymentIntent (fianza = rental.deposit)\n  const { data: intent } = await api.post(\"/payments/create-intent\", {\n    amount: rental.deposit\n  });\n\n  return { clientSecret: intent.client_secret, rental };\n}",
    "frontend/src/features/rentals/RentalList.tsx": "// src/features/rentals/RentalList.tsx\nimport { useAuth } from \"../../hooks/useAuth\";\nimport { useRentals, RentalStatus } from \"./useRentals\";\nimport clsx from \"clsx\";\n\n/* ------------------------------------------------------------------ */\n/*                         Helper visual                              */\n/* ------------------------------------------------------------------ */\nfunction statusLabel(s: RentalStatus) {\n  switch (s) {\n    case \"pending\":\n      return [\"Pendiente\", \"badge badge--danger\"];\n    case \"confirmed\":\n      return [\"Confirmado\", \"badge badge--ok\"];\n    case \"returned\":\n      return [\"Devuelto\", \"badge\"];\n  }\n}\n\n/* ------------------------------------------------------------------ */\n/*                           Componente                               */\n/* ------------------------------------------------------------------ */\nexport default function RentalList() {\n  const { token } = useAuth();\n  const {\n    data: rentals,\n    loading,\n  } = useRentals(token); // ← hook actualizado\n\n  if (!token)\n    return (\n      <p className=\"text-gray-500\">\n        Debes iniciar sesión para ver tus alquileres.\n      </p>\n    );\n\n  if (loading) return <p className=\"text-gray-500\">Cargando…</p>;\n\n  if (!rentals.length)\n    return <p className=\"text-gray-500\">No tienes alquileres activos.</p>;\n\n  return (\n    <div className=\"space-y-2\">\n      {rentals.map(r => {\n        const [txt, cls] = statusLabel(r.status);\n        return (\n          <div\n            key={r.id}\n            className=\"flex items-center justify-between rounded-md bg-white p-3 shadow\"\n          >\n            <span className=\"font-medium\">{r.item.name}</span>\n            <span className={cls}>{txt}</span>\n          </div>\n        );\n      })}\n    </div>\n  );\n}\n",
    "frontend/src/features/rentals/createRental.ts": "// src/features/rentals/createRental.ts\nimport { api } from \"../../api\";\n\n/** Crea un alquiler y devuelve su objeto completo (`RentalOut`). */\nexport async function createRental(item_id: number,\n                                   start_at: string,\n                                   end_at: string) {\n  const { data } = await api.post(\"/rentals/\", { item_id, start_at, end_at });\n  return data;                         // ← incluye `deposit`\n}\n",
    "frontend/src/features/rentals/useRentals.ts": "// src/features/rentals/useRentals.ts\nimport { useQuery } from \"@tanstack/react-query\";\nimport { api } from \"../../api\";\nimport { Item } from \"../items/useItems\";\n\n/* ------------------------------------------------------------------ */\n/*                              Types                                 */\n/* ------------------------------------------------------------------ */\n\nexport type RentalStatus = \"pending\" | \"confirmed\" | \"returned\";\n\nexport type Rental = {\n  id: number;\n  item: Item;\n  start_at: string;\n  end_at: string;\n  deposit: number;\n  status: RentalStatus;       // ← reemplaza a «returned»\n};\n\n/* ------------------------------------------------------------------ */\n/*                               Hook                                 */\n/* ------------------------------------------------------------------ */\n\n/**\n * Devuelve los alquileres del usuario autenticado.\n * La petición solo se dispara cuando `token` es truthy.\n */\nexport function useRentals(token: string | null) {\n  const enabled = Boolean(token);\n\n  const { data, isLoading, refetch } = useQuery<Rental[]>({\n    queryKey: [\"rentals\"],\n    queryFn: () => api.get<Rental[]>(\"/rentals/me\").then(r => r.data),\n    enabled,\n    staleTime: 60_000,\n    retry: false\n  });\n\n  return { data: data ?? [], loading: isLoading, refetch };\n}\n",
    "frontend/src/features/rentals/payments/createIntent.ts": "// src/features/payments/createIntent.ts\nimport { api } from \"../../../api\";\n\nexport async function createIntent(amount: number) {\n  const { data } = await api.post(\"/payments/create-intent\", { amount });\n  return data as { client_secret: string };\n}\n",
    "frontend/src/pages/Register.tsx": "// src/pages/Register.tsx\nimport { useForm } from \"react-hook-form\";\nimport { z } from \"zod\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport zxcvbn from \"zxcvbn\";\nimport { useNavigate } from \"react-router-dom\";\nimport toast from \"react-hot-toast\";\nimport clsx from \"clsx\";\nimport { useEffect, useState } from \"react\";  // +useState for terms modal\nimport { FaEye, FaEyeSlash } from \"react-icons/fa\";  // +eye\n\nimport { register as apiRegister } from \"../features/auth/register\";\nimport { login as apiLogin } from \"../features/auth/login\";\nimport { useAuth } from \"../hooks/useAuth\";\n\nimport Container from \"../components/shared/Container\";\nimport SocialButton from \"../components/ui/SocialButton\";\nimport { FcGoogle } from \"react-icons/fc\";\nimport { FaGithub } from \"react-icons/fa\";\n\nconst schema = z\n  .object({\n    username: z.string().min(3, \"Mín. 3 caracteres\"),\n    email: z.string().email(\"Email inválido\"),\n    password: z.string().min(8, \"Mín. 8 caracteres\"),\n    confirm: z.string(),\n    terms: z.literal(true, { errorMap: () => ({ message: \"Acepta los términos\" }) }),\n  })\n  .refine(data => data.password === data.confirm, {\n    message: \"Las contraseñas no coinciden\",\n    path: [\"confirm\"],\n  });\n\ntype FormData = z.infer<typeof schema>;\n\nexport default function Register() {\n  const navigate = useNavigate();\n  const { login: saveToken } = useAuth();\n\n  const {\n    register,\n    handleSubmit,\n    watch,\n    formState: { errors, isSubmitting },\n  } = useForm<FormData>({ resolver: zodResolver(schema) });\n\n  const pwd = watch(\"password\", \"\");\n  const [showPwd, setShowPwd] = useState(false);  // NEW: Toggle\n  const [showTermsModal, setShowTermsModal] = useState(false);  // NEW: Terms modal\n\n  const onSubmit = async (data: FormData) => {\n    try {\n      await apiRegister(data.username, data.email, data.password);\n      const token = await apiLogin(data.username, data.password);\n      saveToken(token);\n      toast.success(\"Cuenta creada, ¡bienvenido!\");\n      navigate(\"/dashboard\");\n    } catch (err: any) {\n      toast.error(err?.response?.data?.detail ?? \"No se pudo crear la cuenta.\");\n    }\n  };\n\n  useEffect(() => {  // Fade-in\n    const timer = setTimeout(() => document.querySelector('.form-container')?.classList.add('visible'), 100);\n    return () => clearTimeout(timer);\n  }, []);\n\n  const strength = zxcvbn(pwd);\n  const strengthColors = ['bg-red-500', 'bg-orange-400', 'bg-yellow-400', 'bg-lime-500', 'bg-green-600'];\n\n  return (\n    <Container>\n      <main className=\"flex min-h-screen items-center justify-center bg-gray-50\">\n        <div className=\"w-full max-w-md space-y-8 rounded-2xl bg-white p-10 shadow-2xl fade-in form-container transition-opacity duration-500\">  {/* FIXED: +fade-in */}\n          <h1 className=\"text-center text-3xl font-bold text-gray-900\">Crear cuenta</h1>\n\n          <div className=\"space-y-4\">\n            <SocialButton provider=\"google\" icon={FcGoogle} label=\"Continuar con Google\" />\n            <SocialButton provider=\"github\" icon={FaGithub} label=\"Continuar con GitHub\" />\n          </div>\n\n          <div className=\"relative my-6\">\n            <hr className=\"border-gray-300\" />\n            <span className=\"absolute left-1/2 top-1/2 -translate-x-1/2 bg-white px-4 text-sm text-gray-500\">o con email</span>\n          </div>\n\n          <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-6\">\n            <div className=\"relative\">\n              <label htmlFor=\"username\" className=\"absolute -top-2 left-3 bg-white px-1 text-xs text-gray-600\">Nombre de usuario</label>\n              <input id=\"username\" {...register(\"username\")} className=\"form-input w-full rounded-lg border-gray-300 focus:border-brand focus:ring-brand\" placeholder=\" \" />\n              {errors.username && <p className=\"mt-1 text-xs text-red-600 flex items-center gap-1\"><span>⚠️</span>{errors.username.message}</p>}  {/* +icon */}\n            </div>\n\n            <div className=\"relative\">\n              <label htmlFor=\"email\" className=\"absolute -top-2 left-3 bg-white px-1 text-xs text-gray-600\">Email</label>\n              <input id=\"email\" type=\"email\" {...register(\"email\")} className=\"form-input w-full rounded-lg border-gray-300 focus:border-brand focus:ring-brand\" placeholder=\" \" />\n              {errors.email && <p className=\"mt-1 text-xs text-red-600 flex items-center gap-1\"><span>⚠️</span>{errors.email.message}</p>}\n            </div>\n\n            <div className=\"relative\">\n              <label htmlFor=\"password\" className=\"absolute -top-2 left-3 bg-white px-1 text-xs text-gray-600\">Contraseña</label>\n              <input id=\"password\" type={showPwd ? \"text\" : \"password\"} {...register(\"password\")} className=\"form-input w-full rounded-lg border-gray-300 focus:border-brand focus:ring-brand pr-10\" placeholder=\" \" />\n              <button type=\"button\" onClick={() => setShowPwd(!showPwd)} className=\"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-brand\">\n                {showPwd ? <FaEyeSlash className=\"h-5 w-5\" /> : <FaEye className=\"h-5 w-5\" />}\n              </button>\n            </div>\n\n            {/* Strength meter with tips */}\n            {pwd && (\n              <div className=\"space-y-1\">\n                <div className=\"h-2 w-full overflow-hidden rounded bg-gray-200\">\n                  <div style={{ width: `${(strength.score + 1) * 20}%` }} className={clsx(\"h-full transition-all\", strengthColors[strength.score])} />\n                </div>\n                <p className=\"text-xs text-gray-500\">{strength.feedback.suggestions.join(' ')}</p>  {/* +tips from zxcvbn */}\n              </div>\n            )}\n            {errors.password && <p className=\"text-xs text-red-600 flex items-center gap-1\"><span>⚠️</span>{errors.password.message}</p>}\n\n            <div className=\"relative\">\n              <label htmlFor=\"confirm\" className=\"absolute -top-2 left-3 bg-white px-1 text-xs text-gray-600\">Repite contraseña</label>\n              <input id=\"confirm\" type={showPwd ? \"text\" : \"password\"} {...register(\"confirm\")} className=\"form-input w-full rounded-lg border-gray-300 focus:border-brand focus:ring-brand pr-10\" placeholder=\" \" />\n            </div>\n            {errors.confirm && <p className=\"text-xs text-red-600 flex items-center gap-1\"><span>⚠️</span>{errors.confirm.message}</p>}\n\n            <label className=\"flex flex-wrap items-center gap-2 text-sm text-gray-600\">  {/* FIXED: +flex-wrap items-center, gap-2 para better spacing */}\n              <input type=\"checkbox\" {...register(\"terms\")} className=\"rounded border-gray-300 text-brand focus:ring-brand\" />\n              Acepto los <button type=\"button\" onClick={() => setShowTermsModal(true)} className=\"text-brand hover:underline\">Términos y Política de privacidad</button>\n            </label>\n            {errors.terms && <p className=\"text-xs text-red-600 flex items-center gap-1\"><span>⚠️</span>{errors.terms.message}</p>}\n\n            <button className=\"btn w-full rounded-lg py-3 text-base font-semibold\" disabled={isSubmitting}>  {/* +styles */}\n              {isSubmitting ? \"Creando…\" : \"Crear cuenta\"}\n            </button>\n          </form>\n\n          {/* Terms Modal (simple dialog) */}\n          {showTermsModal && (\n            <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50\">\n              <div className=\"max-w-md rounded-lg bg-white p-6 shadow-xl\">\n                <h3 className=\"text-lg font-semibold\">Términos y Privacidad</h3>\n                <p className=\"mt-2 text-sm text-gray-600\">Aquí irían los términos reales. Para demo, cierra.</p>\n                <button onClick={() => setShowTermsModal(false)} className=\"mt-4 btn w-full\">Cerrar</button>\n              </div>\n            </div>\n          )}\n        </div>\n      </main>\n    </Container>\n  );\n}",
    "frontend/src/pages/Login.tsx": "// src/pages/Login.tsx\nimport { FormEvent, useState, useEffect } from \"react\";  // +useEffect para anim\nimport { Link, useNavigate } from \"react-router-dom\";\nimport { useAuth } from \"../hooks/useAuth\";\nimport { login as apiLogin } from \"../features/auth/login\";\nimport { FcGoogle } from \"react-icons/fc\";\nimport { FaGithub, FaEye, FaEyeSlash } from \"react-icons/fa\";  // +eye icons\nimport SocialButton from \"../components/ui/SocialButton\";\nimport Container from \"../components/shared/Container\";\nimport toast from \"react-hot-toast\";\nimport clsx from \"clsx\";\n\nexport default function Login() {\n  const [user, setUser] = useState(\"\");\n  const [pwd, setPwd] = useState(\"\");\n  const [showPwd, setShowPwd] = useState(false);  // NEW: Toggle visibility\n  const [error, setError] = useState<string | null>(null);\n  const [animateError, setAnimateError] = useState(false);  // NEW: Shake anim\n\n  const { login: saveToken } = useAuth();\n  const nav = useNavigate();\n\n  async function handleSubmit(e: FormEvent) {\n    e.preventDefault();\n    try {\n      const token = await apiLogin(user.trim(), pwd);\n      saveToken(token);\n      nav(\"/dashboard\");\n      toast.success(\"¡Bienvenido de nuevo!\");\n      setError(null);\n    } catch {\n      toast.error(\"Usuario o contraseña incorrectos\");\n      setError(\"Credenciales inválidas\");\n      setAnimateError(true);\n      setTimeout(() => setAnimateError(false), 300);  // Reset anim\n    }\n  }\n\n  useEffect(() => {  // Fade-in anim on mount\n    const timer = setTimeout(() => document.querySelector('.form-container')?.classList.add('visible'), 100);\n    return () => clearTimeout(timer);\n  }, []);\n\n  return (\n    <Container>\n      <main className=\"flex min-h-screen items-center justify-center bg-gray-50\">  {/* +bg for pro look */}\n        <div className=\"w-full max-w-md space-y-8 rounded-2xl bg-white p-10 shadow-2xl fade-in form-container transition-opacity duration-500\">  {/* FIXED: +fade-in */}\n          <h1 className=\"text-center text-3xl font-bold text-gray-900\">Iniciar sesión</h1>  {/* +text-3xl */}\n\n          {/* ---------- Login social ---------- */}\n          <div className=\"space-y-4\">\n            <SocialButton provider=\"google\" icon={FcGoogle} label=\"Continuar con Google\" />  {/* Updated label */}\n            <SocialButton provider=\"github\" icon={FaGithub} label=\"Continuar con GitHub\" />\n          </div>\n\n          <div className=\"relative my-6\">\n            <hr className=\"border-gray-300\" />\n            <span className=\"absolute left-1/2 top-1/2 -translate-x-1/2 bg-white px-4 text-sm text-gray-500\">o con email</span>  {/* +text-sm */}\n          </div>\n\n          {/* ---------- Formulario ---------- */}\n          <form onSubmit={handleSubmit} className=\"space-y-6\">\n            <div className=\"relative\">\n              <label htmlFor=\"user\" className=\"absolute -top-2 left-3 bg-white px-1 text-xs text-gray-600\">Usuario</label>  {/* Floating label */}\n              <input\n                id=\"user\"\n                className=\"form-input w-full rounded-lg border-gray-300 focus:border-brand focus:ring-brand\"\n                placeholder=\" \"\n                value={user}\n                onChange={e => setUser(e.target.value)}\n                required\n              />\n            </div>\n\n            <div className=\"relative\">\n              <label htmlFor=\"pwd\" className=\"absolute -top-2 left-3 bg-white px-1 text-xs text-gray-600\">Contraseña</label>\n              <input\n                id=\"pwd\"\n                type={showPwd ? \"text\" : \"password\"}\n                className=\"form-input w-full rounded-lg border-gray-300 focus:border-brand focus:ring-brand pr-10\"  \n                placeholder=\" \"\n                value={pwd}\n                onChange={e => setPwd(e.target.value)}\n                required\n              />\n              <button\n                type=\"button\"\n                onClick={() => setShowPwd(!showPwd)}\n                className=\"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-brand\"\n              >\n                {showPwd ? <FaEyeSlash className=\"h-5 w-5\" /> : <FaEye className=\"h-5 w-5\" />}\n              </button>\n            </div>\n\n            {error && (\n              <p className={clsx(\"text-center text-sm text-red-600 error-shake\", animateError && \"animate-shake\")}>{error}</p> \n            )}\n\n            <div className=\"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between text-sm\">  {/* FIXED: flex-col en mobile, gap-2 para spacing */}\n              <label className=\"flex items-center gap-2\">\n                <input type=\"checkbox\" className=\"rounded border-gray-300 text-brand focus:ring-brand\" />\n                Recordarme\n              </label>\n              <Link to=\"/forgot-password\" className=\"text-brand hover:underline\">\n                ¿Olvidaste tu contraseña?\n              </Link>\n            </div>\n\n            <button className=\"btn w-full rounded-lg py-3 text-base font-semibold\">  {/* +py-3, text-base */}\n              Entrar\n            </button>\n          </form>\n\n          <p className=\"text-center text-sm text-gray-500\">\n            ¿No tienes cuenta? <Link to=\"/register\" className=\"text-brand font-medium hover:underline\">Regístrate</Link>\n          </p>\n        </div>\n      </main>\n    </Container>\n  );\n}",
    "frontend/src/pages/Dashboard.tsx": "import Container from '../components/shared/Container';\nimport ItemList from '../features/items/ItemList';\nimport RentalList from '../features/rentals/RentalList';\nimport Section from '../components/shared/Section';\n\nexport default function Dashboard() {\n  return (\n    <Container>\n      <Section title=\"Mis alquileres\">\n        <RentalList />\n      </Section>\n\n      <Section title=\"Catálogo público\">\n        <ItemList />\n      </Section>\n    </Container>\n  );\n}\n",
    "frontend/src/pages/Home.tsx": "/* -------------------------------------------------------------- */\n/*  src/pages/Home.tsx – landing 2025                             */\n/* -------------------------------------------------------------- */\nimport { Link } from 'react-router-dom';\nimport {\n  ArrowRightIcon,\n  PlusIcon,\n  CloudArrowUpIcon,\n  CalendarDaysIcon,\n  BanknotesIcon,\n  ShieldCheckIcon,\n  UsersIcon,\n  GlobeAltIcon,\n} from '@heroicons/react/24/solid';\nimport { useEffect, useRef } from 'react';\nimport logo from '../assets/agree.jpg';\n\n/* Shared wrappers */\nimport Container from '../components/shared/Container';\nimport Section   from '../components/shared/Section';\n\n/* Home blocks */\nimport TrustBar        from '../components/Home/TrustBar';\nimport CategoryGrid    from '../components/Home/CategoryGrid';\nimport Benefits        from '../components/Home/Benefits';\nimport Stats           from '../components/Home/Stats';\nimport FlowSteps       from '../components/Home/FlowSteps';\nimport Testimonials    from '../components/Home/Testimonials';\nimport IncentiveBanner from '../components/Home/IncentiveBanner';\nimport FAQ             from '../components/Home/FAQ';\nimport LogoCloud       from '../components/Home/LogoCloud';\n\n/* ----------------------------- HERO COPY ----------------------------- */\nconst HERO = {\n  h1     : 'Alquila y gana dinero extra hoy mismo',\n  tagLine: 'Únete a la mayor comunidad local de alquiler de herramientas y gadgets.',\n  bullets: '+3 000 artículos · 24 000 € ahorrados · 0 fraudes',\n};\n\nexport default function Home() {\n  /* Animación secuencial para FlowSteps */\n  const stepsRef = useRef<HTMLDivElement>(null);\n  useEffect(() => {\n    const el = stepsRef.current;\n    if (!el) return;\n    const io = new IntersectionObserver(\n      ([e]) =>\n        e.isIntersecting &&\n        [...e.target.children].forEach((c, i) => {\n          c.classList.add('visible');\n          (c as HTMLElement).style.transitionDelay = `${i * 0.15}s`;\n        }),\n      { threshold: 0.3 }\n    );\n    io.observe(el);\n    return () => io.disconnect();\n  }, []);\n\n  return (\n    <>\n      {/* ----------------------------- HERO ----------------------------- */}\n      <header\n        className=\"\n          relative isolate flex min-h-[90vh] flex-col items-center\n          justify-center overflow-hidden text-center text-white dark:text-gray-100\n        \"\n      >\n        <div className=\"absolute inset-0 -z-10 bg-gradient-to-b from-black/60 via-black/40 to-black/10 dark:from-gray-900/80\" />\n        <img\n          src={logo}\n          alt=\"Vecino entregando una taladradora a otra persona frente a un garaje\"\n          className=\"absolute inset-0 -z-20 h-full w-full object-cover opacity-50\"\n          loading=\"eager\"\n        />\n\n        <Container>\n          <h1 className=\"mx-auto max-w-4xl text-balance text-5xl font-extrabold sm:text-6xl\">\n            {HERO.h1}\n          </h1>\n          <p className=\"mx-auto mt-5 max-w-2xl text-lg/relaxed text-white/90 dark:text-gray-300\">\n            {HERO.tagLine}\n          </p>\n          <p className=\"mt-3 text-sm uppercase tracking-wider text-brand-light\">\n            {HERO.bullets}\n          </p>\n\n          <div className=\"mt-10 flex flex-wrap justify-center gap-4\">\n            <Link to=\"/register\" className=\"btn inline-flex gap-2\">\n              Crear cuenta gratis\n              <ArrowRightIcon className=\"h-5 w-5\" />\n            </Link>\n            <Link to=\"/dashboard#add\" className=\"btn--ghost inline-flex gap-2\">\n              <PlusIcon className=\"h-5 w-5\" />\n              Publicar un ítem\n            </Link>\n          </div>\n        </Container>\n\n        {/* Badge bar */}\n        <TrustBar />\n      </header>\n\n      {/* --------------------------- CATEGORÍAS -------------------------- */}\n      <CategoryGrid />\n\n      {/* ---------------------------- BENEFICIOS ------------------------- */}\n      <Benefits />\n\n      {/* ----------------------------- STATS ---------------------------- */}\n      <Stats />\n\n      {/* --------------------------- CÓMO FUNCIONA ----------------------- */}\n      <FlowSteps ref={stepsRef} />\n\n      {/* ---------------------------- TESTIMONIOS ------------------------ */}\n      <Testimonials />\n\n      {/* ----------------------- INCENTIVO FOMO ------------------------- */}\n      <IncentiveBanner />\n\n      {/* ------------------------------ FAQ ----------------------------- */}\n      <FAQ />\n\n      {/* ------------------------- CLOUD DE LOGOS ----------------------- */}\n      <LogoCloud />\n\n      {/* ---------- CTA FINAL (dentro de IncentiveBanner) --------------- */}\n    </>\n  );\n}\n",
    "frontend/src/pages/ForgotPassword.tsx": "import { FormEvent, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport toast from \"react-hot-toast\";\n\nimport Container from \"../components/shared/Container\";\nimport { forgot } from \"../features/auth/forgot\";\n\nexport default function ForgotPassword() {\n  const [user, setUser] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const nav = useNavigate();\n\n  async function handleSubmit(e: FormEvent) {\n    e.preventDefault();\n    try {\n      setLoading(true);\n      const token = await forgot(user.trim());\n      toast.success(\"Token generado: revisa tu correo (demo: consola)\");\n      console.info(\"🔑 reset_token =\", token);   // ← visible en consola dev\n      nav(`/reset-password?token=${token}`);\n    } catch (err: any) {\n      setLoading(false);\n      const msg =\n        err?.response?.status === 404\n          ? \"Usuario no encontrado\"\n          : err?.response?.data?.detail ?? \"Error inesperado\";\n      toast.error(msg);\n    }\n  }\n\n  return (\n    <Container>\n      <main className=\"flex min-h-[70vh] items-center justify-center\">\n        <form\n          onSubmit={handleSubmit}\n          className=\"w-full max-w-md space-y-6 rounded-xl bg-white p-8 shadow-card\"\n        >\n          <h1 className=\"text-center text-2xl font-bold\">\n            Restablecer contraseña\n          </h1>\n\n          <input\n            value={user}\n            onChange={e => setUser(e.target.value)}\n            placeholder=\"Nombre de usuario\"\n            className=\"form-input w-full\"\n            required\n          />\n\n          <button className=\"btn w-full\" disabled={loading}>\n            {loading ? \"Enviando…\" : \"Generar enlace\"}\n          </button>\n        </form>\n      </main>\n    </Container>\n  );\n}\n",
    "frontend/src/pages/ResetPassword.tsx": "// src/pages/ResetPassword.tsx\nimport { useSearchParams, useNavigate, Link } from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\nimport { z } from \"zod\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport toast from \"react-hot-toast\";\nimport { useEffect, useState } from \"react\";  // +useState for toggle\nimport { FaEye, FaEyeSlash } from \"react-icons/fa\";\n\nimport Container from \"../components/shared/Container\";\nimport { reset } from \"../features/auth/reset\";\nimport clsx from \"clsx\";\nimport zxcvbn from \"zxcvbn\";  // +strength\n\nconst schema = z\n  .object({\n    password: z.string().min(8, \"Mínimo 8 caracteres\"),\n    confirm: z.string()\n  })\n  .refine(d => d.password === d.confirm, {\n    message: \"No coincide\",\n    path: [\"confirm\"]\n  });\n\ntype Form = z.infer<typeof schema>;\n\nexport default function ResetPassword() {\n  const [params] = useSearchParams();\n  const tokenQP = params.get(\"token\") ?? \"\";\n  const nav = useNavigate();\n\n  const {\n    register,\n    handleSubmit,\n    watch,\n    formState: { errors, isSubmitting }\n  } = useForm<Form>({\n    resolver: zodResolver(schema)\n  });\n\n  const pwd = watch(\"password\", \"\");\n  const [showPwd, setShowPwd] = useState(false);  // NEW: Toggle\n\n  const onSubmit = async (data: Form) => {\n    try {\n      await reset(tokenQP, data.password);\n      toast.success(\"Contraseña actualizada\");\n      nav(\"/login\");\n    } catch (err: any) {\n      toast.error(err?.response?.data?.detail ?? \"Token inválido o expirado.\");\n    }\n  };\n\n  useEffect(() => {  // Fade-in\n    const timer = setTimeout(() => document.querySelector('.form-container')?.classList.add('visible'), 100);\n    return () => clearTimeout(timer);\n  }, []);\n\n  const strength = zxcvbn(pwd);\n  const strengthColors = ['bg-red-500', 'bg-orange-400', 'bg-yellow-400', 'bg-lime-500', 'bg-green-600'];\n\n  return (\n    <Container>\n      <main className=\"flex min-h-screen items-center justify-center bg-gray-50\">\n        <form\n          onSubmit={handleSubmit(onSubmit)}\n          className=\"w-full max-w-md space-y-8 rounded-2xl bg-white p-10 shadow-2xl fade-in form-container transition-opacity duration-500\"  // FIXED: +fade-in\n        >\n          <h1 className=\"text-center text-3xl font-bold text-gray-900\">Nueva contraseña</h1>\n\n          <div className=\"relative\">\n            <label htmlFor=\"password\" className=\"absolute -top-2 left-3 bg-white px-1 text-xs text-gray-600\">Contraseña</label>\n            <input id=\"password\" type={showPwd ? \"text\" : \"password\"} {...register(\"password\")} className=\"form-input w-full rounded-lg border-gray-300 focus:border-brand focus:ring-brand pr-10\" placeholder=\" \" />\n            <button type=\"button\" onClick={() => setShowPwd(!showPwd)} className=\"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-brand\">\n              {showPwd ? <FaEyeSlash className=\"h-5 w-5\" /> : <FaEye className=\"h-5 w-5\" />}\n            </button>\n          </div>\n\n          {pwd && (\n            <div className=\"space-y-1\">\n              <div className=\"h-2 w-full overflow-hidden rounded bg-gray-200\">\n                <div style={{ width: `${(strength.score + 1) * 20}%` }} className={clsx(\"h-full transition-all\", strengthColors[strength.score])} />\n              </div>\n              <p className=\"text-xs text-gray-500\">{strength.feedback.suggestions.join(' ')}</p>\n            </div>\n          )}\n          {errors.password && <p className=\"text-xs text-red-600 flex items-center gap-1\"><span>⚠️</span>{errors.password.message}</p>}\n\n          <div className=\"relative\">\n            <label htmlFor=\"confirm\" className=\"absolute -top-2 left-3 bg-white px-1 text-xs text-gray-600\">Repite contraseña</label>\n            <input id=\"confirm\" type={showPwd ? \"text\" : \"password\"} {...register(\"confirm\")} className=\"form-input w-full rounded-lg border-gray-300 focus:border-brand focus:ring-brand pr-10\" placeholder=\" \" />\n          </div>\n          {errors.confirm && <p className=\"text-xs text-red-600 flex items-center gap-1\"><span>⚠️</span>{errors.confirm.message}</p>}\n\n          <button className=\"btn w-full rounded-lg py-3 text-base font-semibold\" disabled={isSubmitting}>\n            {isSubmitting ? \"Guardando…\" : \"Cambiar contraseña\"}\n          </button>\n\n          <p className=\"text-center text-sm text-gray-500\">\n            ¿Recordaste tu clave? <Link to=\"/login\" className=\"text-brand font-medium hover:underline\">Iniciar sesión</Link>\n          </p>\n        </form>\n      </main>\n    </Container>\n  );\n}",
    "frontend/src/components/ui/PaymentModal.tsx": "/* -------------------------------------------------------------------------- */\n/*  src/components/ui/PaymentModal.tsx                                        */\n/* -------------------------------------------------------------------------- */\nimport { Fragment, useState } from \"react\";\nimport { Dialog, Transition } from \"@headlessui/react\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport {\n  Elements,\n  PaymentElement,\n  useElements,\n  useStripe,\n} from \"@stripe/react-stripe-js\";\nimport { ArrowPathIcon, XMarkIcon } from \"@heroicons/react/24/outline\";\nimport toast from \"react-hot-toast\";\nimport { useQueryClient } from \"@tanstack/react-query\";\n\n/* ⚠️  usa tu clave pública de Stripe (env var VITE_STRIPE_PK) */\nconst stripePromise = loadStripe(import.meta.env.VITE_STRIPE_PK!);\n\ntype Props = {\n  open: boolean;\n  clientSecret: string;\n  onClose: () => void;\n  onSuccess: () => void;\n};\n\nexport default function PaymentModal(props: Props) {\n  const { open, clientSecret, onClose, onSuccess } = props;\n\n  if (!clientSecret) return null;\n\n  return (\n    <Transition show={open} as={Fragment}>\n      <Dialog onClose={onClose} className=\"relative z-[60]\">\n        {/* ---- backdrop ---- */}\n        <Transition.Child\n          as={Fragment}\n          enter=\"ease-out duration-200\"\n          enterFrom=\"opacity-0\"\n          enterTo=\"opacity-100\"\n          leave=\"ease-in duration-150\"\n          leaveFrom=\"opacity-100\"\n          leaveTo=\"opacity-0\"\n        >\n          <div className=\"fixed inset-0 bg-black/40 backdrop-blur-sm\" />\n        </Transition.Child>\n\n        {/* ---- panel ---- */}\n        <div className=\"fixed inset-0 grid place-items-center p-4\">\n          <Transition.Child\n            as={Fragment}\n            enter=\"ease-out duration-200\"\n            enterFrom=\"scale-95 opacity-0\"\n            enterTo=\"scale-100 opacity-100\"\n            leave=\"ease-in duration-150\"\n            leaveFrom=\"scale-100 opacity-100\"\n            leaveTo=\"scale-95 opacity-0\"\n          >\n            <Dialog.Panel className=\"w-full max-w-md overflow-hidden rounded-xl bg-white shadow-xl\">\n              <header className=\"flex items-center justify-between border-b px-5 py-4\">\n                <Dialog.Title className=\"text-base font-semibold\">\n                  Pago de fianza\n                </Dialog.Title>\n                <button\n                  onClick={onClose}\n                  className=\"rounded p-1 text-gray-500 hover:bg-gray-100\"\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n              </header>\n\n              <Elements\n                stripe={stripePromise}\n                options={{ clientSecret, appearance: { theme: \"stripe\" } }}\n              >\n                <CheckoutForm onCancel={onClose} onSuccess={onSuccess} />\n              </Elements>\n            </Dialog.Panel>\n          </Transition.Child>\n        </div>\n      </Dialog>\n    </Transition>\n  );\n}\n\n/* ------------------------ formulario interno ----------------------------- */\nfunction CheckoutForm({\n  onCancel,\n  onSuccess,\n}: {\n  onCancel: () => void;\n  onSuccess: () => void;\n}) {\n  const stripe = useStripe();\n  const elements = useElements();\n  const [processing, setProcessing] = useState(false);\n  const qc = useQueryClient();  // ← invalidate cache\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!stripe || !elements) return;\n\n    setProcessing(true);\n    const { error } = await stripe.confirmPayment({\n      elements,\n      redirect: \"if_required\",\n    });\n\n    setProcessing(false);\n\n    if (error) {\n      toast.error(error.message ?? \"No se pudo procesar el pago.\");\n    } else {\n      /* 🔄 refrescar lista de alquileres */\n      qc.invalidateQueries({ queryKey: [\"rentals\"] });\n      onSuccess(); // ← callback del padre\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit} className=\"space-y-6 p-6\">\n      {/* Tarjeta / Wallets / iDEAL, etc. */}\n      <PaymentElement />\n\n      <div className=\"flex items-center justify-end gap-3\">\n        <button\n          type=\"button\"\n          onClick={onCancel}\n          className=\"btn-secondary px-4 py-2 text-sm\"\n        >\n          Cancelar\n        </button>\n\n        <button\n          disabled={!stripe || !elements || processing}\n          className=\"btn px-6 py-2 text-sm\"\n        >\n          {processing ? (\n            <>\n              <ArrowPathIcon className=\"mr-2 h-5 w-5 animate-spin\" />\n              Procesando…\n            </>\n          ) : (\n            \"Pagar y confirmar\"\n          )}\n        </button>\n      </div>\n    </form>\n  );\n}\n",
    "frontend/src/components/ui/SkeletonCard.tsx": "export default function SkeletonCard() {\n  return (\n    <article\n      className=\"\n        flex flex-col overflow-hidden rounded-lg bg-white shadow-card\n        animate-pulse\n      \"\n    >\n      {/* zona de imagen (mantiene proporción 4:3) */}\n      <div className=\"aspect-[4/3] w-full bg-gray-200\" />\n\n      {/* zona de texto */}\n      <div className=\"space-y-2 p-4\">\n        <div className=\"h-4 w-2/3 rounded bg-gray-200\" />\n        <div className=\"h-4 w-1/3 rounded bg-gray-200\" />\n      </div>\n    </article>\n  );\n}\n",
    "frontend/src/components/ui/LazyImage.tsx": "import { useState } from 'react';\n\ntype Props = {\n  src: string;\n  alt: string;\n  className?: string;\n  /** ancho estimado para el atributo `sizes` (ej. \"100vw\", \"50vw\") */\n  sizes?: string;\n};\n\nexport default function LazyImage({\n  src,\n  alt,\n  className = '',\n  sizes = '100vw'\n}: Props) {\n  const [loaded, setLoaded] = useState(false);\n\n  /* genera srcset (320-640-960 px) */\n  const srcset = [320, 640, 960]\n    .map(w => `${src.replace(/(\\?.*)?$/, '')}?w=${w} ${w}w`)\n    .join(', ');\n\n  return (\n    <img\n      src={src}\n      srcSet={srcset}\n      sizes={sizes}\n      loading=\"lazy\"\n      decoding=\"async\"                    /* 🆕 */\n      onLoad={() => setLoaded(true)}\n      className={`${className} transition-opacity duration-500 ${\n        loaded ? 'opacity-100' : 'opacity-0'\n      }`}\n      alt={alt}\n    />\n  );\n}\n",
    "frontend/src/components/ui/ItemCard.tsx": "/* -------------------------------------------------------------------------- */\n/*  src/components/ui/ItemCard.tsx                                            */\n/* -------------------------------------------------------------------------- */\nimport { useState } from \"react\";\nimport { HeartIcon, EyeIcon } from \"@heroicons/react/24/solid\";\nimport clsx from \"clsx\";\n\nimport { Item } from \"../../features/items/useItems\";\nimport { resolveImage } from \"../../utils\";\nimport LazyImage from \"./LazyImage\";\nimport ProductDetailModal from \"../../features/items/item-detail/ProductDetailModal\";\n\nexport default function ItemCard({ item }: { item: Item }) {\n  const [open, setOpen] = useState(false);\n\n  /* -------- portada (1ª del array o la legacy) -------- */\n  const cover = item.image_urls?.[0] ?? item.image_url;\n\n  const imgSrc = resolveImage(\n    cover,\n    `https://source.unsplash.com/640x480/?${encodeURIComponent(item.name)}`\n  );\n\n  return (\n    <>\n      <article\n        onClick={() => setOpen(true)}\n        className=\"flex cursor-pointer flex-col overflow-hidden rounded-lg bg-surface shadow-card transition-transform duration-200 hover:-translate-y-1 hover:shadow-cardHover\"\n      >\n        {/* ---------- Foto ---------- */}\n        <div className=\"relative\">\n          <LazyImage\n            src={imgSrc}\n            alt={item.name}\n            className=\"aspect-[4/3] w-full object-contain p-2\"\n          />\n\n          {!item.available && (\n            <span className=\"absolute left-0 top-0 rounded-br-md bg-red-600/90 px-2 py-0.5 text-xs font-semibold uppercase tracking-wide text-white\">\n              Alquilado\n            </span>\n          )}\n\n          {/* acciones rápidas */}\n          <div className=\"absolute inset-0 flex items-start justify-end gap-2 p-2 opacity-0 transition-opacity hover:opacity-100\">\n            <IconBtn title=\"Vista rápida\">\n              <EyeIcon className=\"h-5 w-5\" />\n            </IconBtn>\n            <IconBtn title=\"Favorito\">\n              <HeartIcon className=\"h-5 w-5\" />\n            </IconBtn>\n          </div>\n        </div>\n\n        {/* ---------- Info ---------- */}\n        <div className=\"flex flex-1 flex-col gap-2 px-4 pb-4\">\n          <h3 className=\"line-clamp-1 text-lg font-semibold\">{item.name}</h3>\n\n          {item.description && (\n            <p className=\"line-clamp-2 text-sm text-gray-600\">\n              {item.description}\n            </p>\n          )}\n\n          <div className=\"mt-auto flex items-center justify-between\">\n            <p className=\"text-base font-bold text-brand\">\n              {item.price_per_h.toFixed(2)} €/h\n            </p>\n            <span\n              className={clsx(\n                \"badge\",\n                item.available ? \"badge--ok\" : \"badge--danger\"\n              )}\n            >\n              {item.available ? \"Disponible\" : \"Alquilado\"}\n            </span>\n          </div>\n        </div>\n      </article>\n\n      {/* ---------- Modal de detalle ---------- */}\n      {/*  ⬇️  Enviamos el ID correcto                                  */}\n      <ProductDetailModal\n        open={open}\n        onClose={() => setOpen(false)}\n        itemId={item.id}\n      />\n    </>\n  );\n}\n\n/* -------------------------------------------------------------------------- */\n/*                                 Helpers                                    */\n/* -------------------------------------------------------------------------- */\nfunction IconBtn({\n  children,\n  title\n}: {\n  children: React.ReactNode;\n  title: string;\n}) {\n  return (\n    <button\n      type=\"button\"\n      title={title}\n      onClick={e => e.stopPropagation()}\n      className=\"rounded-full bg-white/90 p-1 text-gray-600 shadow transition-colors hover:bg-white\"\n    >\n      {children}\n    </button>\n  );\n}\n",
    "frontend/src/components/ui/SearchBar.tsx": "import { useForm } from 'react-hook-form';\n\ntype Props = { onSubmit: (q: URLSearchParams) => void };\n\nexport default function SearchBar({ onSubmit }: Props) {\n  const { register, handleSubmit, reset } = useForm<{\n    q: string;\n    min: number | undefined;\n    max: number | undefined;\n  }>({ defaultValues: { q: '', min: undefined, max: undefined } });\n\n  return (\n    <form\n      onSubmit={handleSubmit(values => {\n        const params = new URLSearchParams();\n        if (values.q) params.set('name', values.q);\n        if (values.min) params.set('min_price', values.min.toString());\n        if (values.max) params.set('max_price', values.max.toString());\n        onSubmit(params);\n      })}\n      className=\"flex flex-wrap items-end gap-3\"\n    >\n      <input\n        {...register('q')}\n        placeholder=\"Buscar producto…\"\n        className=\"form-input w-52\"\n      />\n      <input\n        {...register('min', { valueAsNumber: true })}\n        type=\"number\"\n        step=\"0.1\"\n        min={0}\n        placeholder=\"€ mínimo\"\n        className=\"form-input w-32\"\n      />\n      <input\n        {...register('max', { valueAsNumber: true })}\n        type=\"number\"\n        step=\"0.1\"\n        min={0}\n        placeholder=\"€ máximo\"\n        className=\"form-input w-32\"\n      />\n      <button className=\"btn\">Filtrar</button>\n      <button\n        type=\"button\"\n        onClick={() => {\n          reset();\n          onSubmit(new URLSearchParams());\n        }}\n        className=\"btn--ghost\"\n      >\n        Limpiar\n      </button>\n    </form>\n  );\n}\n",
    "frontend/src/components/ui/ItemDetailModal.tsx": "/* -------------------------------------------------------------------------- */\n/*  src/components/ui/ItemDetailModal.tsx                                     */\n/*  – Integra reserva vía micro-servicio **rentals**                          */\n/*    • logos de pago encima del CTA                                          */\n/*    • botón «Reservar ahora» XL que crea el alquiler                        */\n/* -------------------------------------------------------------------------- */\nimport { Fragment, useState } from \"react\";\nimport { Dialog, Transition } from \"@headlessui/react\";\nimport {\n  XMarkIcon,\n  StarIcon,\n  ShieldCheckIcon,\n  ClockIcon,\n  MapPinIcon,\n  CheckBadgeIcon,\n  UserCircleIcon,\n  ArrowPathIcon,\n} from \"@heroicons/react/24/outline\";\nimport { FaFacebookF, FaTwitter, FaWhatsapp } from \"react-icons/fa\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport toast from \"react-hot-toast\";\nimport clsx from \"clsx\";\n\nimport { Item } from \"../../features/items/useItems\";\nimport { createRental } from \"../../features/rentals/createRental\";\nimport { useAuth } from \"../../hooks/useAuth\";\nimport { resolveImage } from \"../../utils\";\nimport LazyImage from \"./LazyImage\";\n\n/* ------------------- helpers (Rating, Feature, Description) --------------- */\n\nconst Rating = ({ value }: { value: number }) => (\n  <div className=\"flex items-center gap-1\">\n    {Array.from({ length: 5 }).map((_, i) => (\n      <StarIcon\n        key={i}\n        className={clsx(\n          \"h-4 w-4\",\n          i < value ? \"fill-amber-400 stroke-amber-400\" : \"stroke-gray-300\"\n        )}\n      />\n    ))}\n    <span className=\"ml-1 text-xs text-gray-500\">({value.toFixed(1)})</span>\n  </div>\n);\n\nconst Feature = ({\n  icon: Icon,\n  text,\n}: {\n  icon: (p: any) => JSX.Element;\n  text: string;\n}) => (\n  <li className=\"flex items-center gap-2\">\n    <Icon className=\"h-4 w-4 shrink-0 text-brand\" />\n    {text}\n  </li>\n);\n\nconst Description = ({ text }: { text: string }) => {\n  const bullets = text\n    .split(/(?:\\u2022|\\n)/) // • o salto de línea\n    .map((t) => t.trim())\n    .filter(Boolean);\n\n  if (bullets.length > 1) {\n    return (\n      <ul className=\"list-disc space-y-1 pl-5 text-sm leading-relaxed text-gray-700\">\n        {bullets.map((b, i) => (\n          <li key={i}>{b}</li>\n        ))}\n      </ul>\n    );\n  }\n  return (\n    <p className=\"whitespace-pre-line text-sm leading-relaxed text-gray-700\">\n      {text}\n    </p>\n  );\n};\n\n/* -------------------------------------------------------------------------- */\n\ntype Props = { open: boolean; onClose: () => void; item: Item | null };\n\nexport default function ItemDetailModal({ open, onClose, item }: Props) {\n  if (!item) return null;\n\n  /* ---------- galería ---------- */\n  const gallery =\n    item.image_urls?.length\n      ? item.image_urls\n      : [\n          resolveImage(\n            item.image_url,\n            `https://source.unsplash.com/800x600/?${encodeURIComponent(\n              item.name\n            )}`\n          ),\n        ];\n  const [active, setActive] = useState(0);\n\n  /* ---------- specs demo ---------- */\n  const SPECS: Record<string, string | number> = {\n    Potencia: \"600 W\",\n    Peso: \"1,8 kg\",\n    Velocidad: \"0-2 800 rpm\",\n  };\n\n  /* ---------- reserva rentals ---------- */\n  const { token } = useAuth();\n\n  const mutation = useMutation({\n    mutationFn: () => {\n      const now = new Date();\n      const plus1h = new Date(now.getTime() + 60 * 60 * 1000);\n      return createRental(item.id, now.toISOString(), plus1h.toISOString());\n    },\n    onSuccess: (r) => {\n      toast.success(\n        `Reserva creada ✔️  Fianza retenida: ${r.deposit.toFixed(2)} €`\n      );\n      onClose();\n    },\n    onError: (err: any) => {\n      const msg =\n        err?.response?.data?.detail ??\n        \"No se pudo reservar, inténtalo más tarde.\";\n      toast.error(msg);\n    },\n  });\n\n  const handleReserve = () => {\n    if (!token) return toast.error(\"Debes iniciar sesión primero\");\n    if (!item.available)\n      return toast.error(\"Este ítem no está disponible actualmente\");\n    mutation.mutate();\n  };\n\n  /* ---------------------------------------------------------------------- */\n  return (\n    <Transition show={open} as={Fragment}>\n      <Dialog onClose={onClose} className=\"relative z-50\">\n        {/* ---- backdrop ---- */}\n        <Transition.Child\n          as={Fragment}\n          enter=\"ease-out duration-200\"\n          enterFrom=\"opacity-0\"\n          enterTo=\"opacity-100\"\n          leave=\"ease-in duration-150\"\n          leaveFrom=\"opacity-100\"\n          leaveTo=\"opacity-0\"\n        >\n          <div className=\"fixed inset-0 bg-black/40 backdrop-blur-sm\" />\n        </Transition.Child>\n\n        {/* ---- wrapper ---- */}\n        <div className=\"fixed inset-0 grid place-items-center p-4\">\n          <Transition.Child\n            as={Fragment}\n            enter=\"ease-out duration-200\"\n            enterFrom=\"scale-95 opacity-0\"\n            enterTo=\"scale-100 opacity-100\"\n            leave=\"ease-in duration-150\"\n            leaveFrom=\"scale-100 opacity-100\"\n            leaveTo=\"scale-95 opacity-0\"\n          >\n            <Dialog.Panel className=\"flex w-full max-w-6xl max-h-[95vh] flex-col overflow-hidden rounded-xl bg-white shadow-xl\">\n              {/* ---------------- Header ---------------- */}\n              <header className=\"flex items-center justify-between border-b px-6 py-4\">\n                <Dialog.Title className=\"text-lg font-semibold\">\n                  {item.name}\n                </Dialog.Title>\n                <button\n                  onClick={onClose}\n                  className=\"rounded p-1 text-gray-500 hover:bg-gray-100\"\n                >\n                  <XMarkIcon className=\"h-6 w-6\" />\n                </button>\n              </header>\n\n              {/* ---------------- Body ---------------- */}\n              <section className=\"flex flex-1 flex-col gap-8 overflow-y-auto p-6 lg:flex-row\">\n                {/* ---------- Galería ---------- */}\n                <div className=\"lg:w-1/2\">\n                  <div className=\"aspect-video overflow-hidden rounded-lg border\">\n                    <LazyImage\n                      src={gallery[active]}\n                      alt={item.name}\n                      className=\"h-full w-full object-contain\"\n                      sizes=\"(min-width:1024px) 50vw, 90vw\"\n                    />\n                  </div>\n\n                  {gallery.length > 1 && (\n                    <div className=\"mt-3 flex gap-2 overflow-x-auto\">\n                      {gallery.map((src, i) => (\n                        <button\n                          key={i}\n                          onClick={() => setActive(i)}\n                          className={clsx(\n                            \"shrink-0 overflow-hidden rounded-md border\",\n                            active === i && \"ring-2 ring-brand\"\n                          )}\n                        >\n                          <LazyImage\n                            src={src}\n                            alt=\"\"\n                            className=\"h-16 w-24 object-cover\"\n                            sizes=\"96px\"\n                          />\n                        </button>\n                      ))}\n                    </div>\n                  )}\n                </div>\n\n                {/* ---------- Ficha ---------- */}\n                <div className=\"flex flex-1 flex-col gap-6\">\n                  <div className=\"flex flex-col gap-1 sm:flex-row sm:items-center sm:justify-between\">\n                    <p className=\"text-3xl font-bold text-brand\">\n                      {item.price_per_h.toFixed(2)} €/h\n                    </p>\n                    <Rating value={4} />\n                  </div>\n\n                  {item.description ? (\n                    <Description text={item.description} />\n                  ) : (\n                    <p className=\"text-sm text-gray-500\">Sin descripción.</p>\n                  )}\n\n                  <table className=\"mt-2 w-full max-w-sm text-sm\">\n                    <tbody>\n                      {Object.entries(SPECS).map(([k, v]) => (\n                        <tr key={k} className=\"border-b last:border-0\">\n                          <td className=\"py-1 pr-4 text-gray-600\">{k}</td>\n                          <td className=\"py-1 font-medium\">{v}</td>\n                        </tr>\n                      ))}\n                    </tbody>\n                  </table>\n\n                  {!!item.categories?.length && (\n                    <div className=\"flex flex-wrap gap-2\">\n                      {item.categories.map((c) => (\n                        <span\n                          key={c.id}\n                          className=\"rounded-full bg-gray-100 px-3 py-0.5 text-xs text-gray-600\"\n                        >\n                          {c.name}\n                        </span>\n                      ))}\n                    </div>\n                  )}\n\n                  {/* vendedor (placeholder) */}\n                  <div className=\"flex items-center gap-3 rounded-md bg-gray-50 p-4\">\n                    <UserCircleIcon className=\"h-10 w-10 text-gray-400\" />\n                    <div className=\"flex-1\">\n                      <p className=\"flex items-center gap-1 text-sm font-semibold\">\n                        Juan P.\n                        <CheckBadgeIcon className=\"h-4 w-4 text-emerald-500\" />\n                      </p>\n                      <p className=\"text-xs text-gray-500\">\n                        Propietario verificado\n                      </p>\n                    </div>\n                  </div>\n\n                  <p className=\"flex items-center gap-1 text-xs text-gray-500\">\n                    <MapPinIcon className=\"h-4 w-4\" />\n                    Recogida en Madrid 28010\n                  </p>\n\n                  <ul className=\"space-y-1 text-sm\">\n                    <Feature\n                      icon={ShieldCheckIcon}\n                      text=\"Pago seguro con fianza\"\n                    />\n                    <Feature\n                      icon={ClockIcon}\n                      text=\"Cancelación gratis hasta 12 h antes\"\n                    />\n                  </ul>\n\n                  {/* redes */}\n                  <div className=\"mt-3 flex gap-4\">\n                    <Social icon={FaFacebookF} label=\"Facebook\" />\n                    <Social icon={FaTwitter} label=\"Twitter\" />\n                    <Social icon={FaWhatsapp} label=\"WhatsApp\" />\n                  </div>\n\n                  {/* --------- LOGOS de pago --------- */}\n                  <div className=\"mt-6 flex justify-center gap-10 opacity-80\">\n                    <img\n                      src=\"/src/assets/payments/visa.svg\"\n                      alt=\"Visa\"\n                      className=\"h-8 md:h-10 w-auto\"\n                    />\n                    <img\n                      src=\"/src/assets/payments/mastercard.svg\"\n                      alt=\"Mastercard\"\n                      className=\"h-8 md:h-10 w-auto\"\n                    />\n                    <img\n                      src=\"/src/assets/payments/paypal.svg\"\n                      alt=\"PayPal\"\n                      className=\"h-8 md:h-10 w-auto\"\n                    />\n                  </div>\n\n                  {/* CTA – XL */}\n                  <button\n                    onClick={handleReserve}\n                    disabled={mutation.isLoading}\n                    className=\"btn mt-4 w-full lg:max-w-xl py-4 text-lg\"\n                  >\n                    {mutation.isLoading ? (\n                      <>\n                        <ArrowPathIcon className=\"mr-3 h-6 w-6 animate-spin\" />\n                        Reservando…\n                      </>\n                    ) : (\n                      \"Reservar ahora\"\n                    )}\n                  </button>\n                </div>\n              </section>\n            </Dialog.Panel>\n          </Transition.Child>\n        </div>\n      </Dialog>\n    </Transition>\n  );\n}\n\n/* --------------------------- Social button ------------------------------- */\nfunction Social({\n  icon: Icon,\n  label,\n}: {\n  icon: (p: any) => JSX.Element;\n  label: string;\n}) {\n  return (\n    <a\n      href=\"#share\"\n      aria-label={`Compartir en ${label}`}\n      className=\"rounded-full bg-gray-100 p-2 text-gray-600 transition-colors hover:bg-gray-200\"\n    >\n      <Icon className=\"h-4 w-4\" />\n    </a>\n  );\n}\n",
    "frontend/src/components/ui/SocialButton.tsx": "// src/components/ui/SocialButton.tsx\nimport { IconType } from 'react-icons';\nimport clsx from 'clsx';\n\ntype Props = {\n  icon: IconType;\n  label: string;\n  provider: 'google' | 'github';\n};\n\nexport default function SocialButton({ icon: Icon, label, provider }: Props) {\n  return (\n    <a\n      href={`/api/oauth/${provider}`}           /* El backend redirige al proveedor */\n      className={clsx(\n        'btn flex w-full items-center justify-center gap-2',\n        provider === 'google' && 'bg-white text-gray-700 shadow border hover:bg-gray-50',\n        provider === 'github' && 'bg-gray-900 text-white hover:bg-gray-800'\n      )}\n    >\n      <Icon className=\"h-5 w-5\" />\n      {label}\n    </a>\n  );\n}\n",
    "frontend/src/components/ui/QuickViewModal.tsx": "/* -------------------------------------------------------------------------- */\n/*  src/components/ui/QuickViewModal.tsx                                      */\n/*  – ahora permite reservar el ítem vía micro-servicio **rentals**           */\n/* -------------------------------------------------------------------------- */\nimport { Fragment } from \"react\";\nimport { Dialog, Transition } from \"@headlessui/react\";\nimport {\n  XMarkIcon,\n  StarIcon,\n  ArrowPathIcon,\n} from \"@heroicons/react/24/outline\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport toast from \"react-hot-toast\";\nimport clsx from \"clsx\";\n\nimport { Item } from \"../../features/items/useItems\";\nimport { createRental } from \"../../features/rentals/createRental\";\nimport { useAuth } from \"../../hooks/useAuth\";\nimport LazyImage from \"./LazyImage\";\nimport { resolveImage } from \"../../utils\";\n\ntype Props = {\n  open: boolean;\n  onClose: () => void;\n  item: Item | null;\n};\n\nexport default function QuickViewModal({ open, onClose, item }: Props) {\n  /* ─────────── guard clause ─────────── */\n  if (!item) return null;\n\n  /* portada (1ª imagen o fallback) */\n  const cover = item.image_urls?.[0] ?? item.image_url;\n  const imgSrc = resolveImage(\n    cover,\n    `https://source.unsplash.com/800x600/?${encodeURIComponent(item.name)}`\n  );\n\n  /* ─────────── auth + reserva ─────────── */\n  const { token } = useAuth();\n\n  /* reserva de **1 h** a partir de “ya” (demo) */\n  const reserve = useMutation({\n    mutationFn: () => {\n      const now = new Date();\n      const plus1h = new Date(now.getTime() + 60 * 60 * 1000);\n      return createRental(item.id, now.toISOString(), plus1h.toISOString());\n    },\n    onSuccess: data => {\n      toast.success(\n        `Reserva confirmada ✔️  •  Fianza: ${data.deposit.toFixed(2)} €`\n      );\n      onClose();\n    },\n    onError: (err: any) => {\n      const msg =\n        err?.response?.data?.detail ??\n        \"No se pudo crear la reserva. Inténtalo más tarde.\";\n      toast.error(msg);\n    },\n  });\n\n  const handleReserve = () => {\n    if (!token) return toast.error(\"Debes iniciar sesión\");\n    if (!item.available)\n      return toast.error(\"Este ítem no está disponible ahora mismo\");\n    reserve.mutate();\n  };\n\n  /* ────────────────── UI ────────────────── */\n  return (\n    <Transition show={open} as={Fragment}>\n      <Dialog onClose={onClose} className=\"relative z-50\">\n        {/* ---------- Backdrop ---------- */}\n        <Transition.Child\n          as={Fragment}\n          enter=\"ease-out duration-200\"\n          enterFrom=\"opacity-0\"\n          enterTo=\"opacity-100\"\n          leave=\"ease-in duration-150\"\n          leaveFrom=\"opacity-100\"\n          leaveTo=\"opacity-0\"\n        >\n          <div className=\"fixed inset-0 bg-black/40 backdrop-blur-sm\" />\n        </Transition.Child>\n\n        {/* ---------- Panel ---------- */}\n        <div className=\"fixed inset-0 grid place-items-center p-4\">\n          <Transition.Child\n            as={Fragment}\n            enter=\"ease-out duration-200\"\n            enterFrom=\"scale-95 opacity-0\"\n            enterTo=\"scale-100 opacity-100\"\n            leave=\"ease-in duration-150\"\n            leaveFrom=\"scale-100 opacity-100\"\n            leaveTo=\"scale-95 opacity-0\"\n          >\n            <Dialog.Panel className=\"flex max-h-[90vh] w-full max-w-3xl flex-col overflow-hidden rounded-xl bg-white shadow-xl\">\n              {/* ───────── header ───────── */}\n              <header className=\"flex items-center justify-between border-b p-4\">\n                <Dialog.Title className=\"text-lg font-semibold\">\n                  {item.name}\n                </Dialog.Title>\n                <button\n                  onClick={onClose}\n                  className=\"rounded p-1 text-gray-500 hover:bg-gray-100\"\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n              </header>\n\n              {/* ───────── body ───────── */}\n              <section className=\"grid gap-6 overflow-y-auto p-6 md:grid-cols-2\">\n                {/* imagen */}\n                <div className=\"flex items-center justify-center\">\n                  <LazyImage\n                    src={imgSrc}\n                    alt={item.name}\n                    className=\"w-full max-h-[60vh] rounded-lg object-contain\"\n                  />\n                </div>\n\n                {/* info */}\n                <div className=\"flex flex-col gap-4\">\n                  <p className=\"text-2xl font-bold text-brand\">\n                    {item.price_per_h.toFixed(2)} €/h\n                  </p>\n\n                  {/* rating provisional */}\n                  <div className=\"flex items-center gap-1\">\n                    {Array.from({ length: 5 }).map((_, i) => (\n                      <StarIcon\n                        key={i}\n                        className={clsx(\n                          \"h-5 w-5\",\n                          i < 4\n                            ? \"fill-amber-400 stroke-amber-400\"\n                            : \"stroke-gray-300\"\n                        )}\n                      />\n                    ))}\n                    <span className=\"ml-1 text-sm text-gray-500\">(4,0)</span>\n                  </div>\n\n                  {item.description ? (\n                    <p className=\"prose max-w-none text-sm leading-relaxed\">\n                      {item.description}\n                    </p>\n                  ) : (\n                    <p className=\"text-sm text-gray-500\">Sin descripción.</p>\n                  )}\n\n                  {!!item.categories?.length && (\n                    <div className=\"flex flex-wrap gap-2\">\n                      {item.categories.map(c => (\n                        <span\n                          key={c.id}\n                          className=\"rounded-full bg-gray-100 px-3 py-0.5 text-xs text-gray-600\"\n                        >\n                          {c.name}\n                        </span>\n                      ))}\n                    </div>\n                  )}\n\n                  {/* ───────── CTA ───────── */}\n                  <button\n                    onClick={handleReserve}\n                    disabled={reserve.isLoading}\n                    className=\"btn mt-auto w-full\"\n                  >\n                    {reserve.isLoading ? (\n                      <>\n                        <ArrowPathIcon className=\"mr-2 h-5 w-5 animate-spin\" />\n                        Reservando…\n                      </>\n                    ) : (\n                      \"Reservar ahora\"\n                    )}\n                  </button>\n                </div>\n              </section>\n            </Dialog.Panel>\n          </Transition.Child>\n        </div>\n      </Dialog>\n    </Transition>\n  );\n}\n",
    "frontend/src/components/shared/Section.tsx": "type Props = {\n  title?: string;\n  children: React.ReactNode;\n  id?: string;\n};\n\nexport default function Section({ title, children, id }: Props) {\n  return (\n    <section id={id} className=\"space-y-6 py-16\">\n      {title && (\n        <h2 className=\"text-center text-3xl font-bold tracking-tight\">{title}</h2>\n      )}\n      {children}\n    </section>\n  );\n}\n",
    "frontend/src/components/shared/Container.tsx": "export default function Container({ children }: { children: React.ReactNode }) {\n  return <div className=\"container\">{children}</div>;\n}\n",
    "frontend/src/components/layout/Footer.tsx": "/* -------------------------------------------------------------------------- */\n/*  src/components/layout/Footer.tsx                                          */\n/* -------------------------------------------------------------------------- */\nimport {\n  FaGithub,\n  FaLinkedin,\n  FaTwitter,\n  FaInstagram,\n} from 'react-icons/fa6';\nimport { Link } from 'react-router-dom';\nimport logo from '../../assets/logo.png';\n\nconst year = new Date().getFullYear();\n\nexport default function Footer() {\n  return (\n    <footer className=\"bg-gray-900 text-gray-300\">\n      {/* ----------------------------- ZONA SUPERIOR ----------------------------- */}\n      <div className=\"container mx-auto grid gap-12 px-6 py-16 sm:grid-cols-2 lg:grid-cols-5\">\n        {/* Marca + descripción */}\n        <div className=\"space-y-4 lg:col-span-2\">\n          <Link to=\"/\" className=\"flex items-center gap-2\">\n            <img\n              src={logo}\n              alt=\"Logo Rental‑MVP\"\n              className=\"h-10 w-auto\"\n              decoding=\"async\"\n            />\n            <span className=\"sr-only\">Rental‑MVP</span>\n          </Link>\n          <p className=\"max-w-sm text-sm leading-relaxed text-gray-400\">\n            Plataforma de alquiler P2P para herramientas, gadgets y mucho\n            más. Monetiza lo que tienes y ayuda al planeta reduciendo el\n            consumo masivo.\n          </p>\n        </div>\n\n        {/* Navegación */}\n        <FooterCol title=\"Producto\">\n          <FooterLink to=\"/\">Explorar</FooterLink>\n          <FooterLink to=\"/dashboard#add\">\n            Publicar ítem\n          </FooterLink>\n          <FooterLink to=\"/pricing\">Precios</FooterLink>\n          <FooterLink to=\"/docs\">Documentación API</FooterLink>\n        </FooterCol>\n\n        <FooterCol title=\"Empresa\">\n          <FooterLink to=\"/about\">Sobre nosotros</FooterLink>\n          <FooterLink to=\"/blog\">Blog</FooterLink>\n          <FooterLink to=\"/careers\">Empleo</FooterLink>\n          <FooterLink to=\"/contact\">Contacto</FooterLink>\n        </FooterCol>\n\n        <FooterCol title=\"Legal\">\n          <FooterLink to=\"/legal/terms\">Términos</FooterLink>\n          <FooterLink to=\"/legal/privacy\">Privacidad</FooterLink>\n          <FooterLink to=\"/legal/cookies\">Cookies</FooterLink>\n          <FooterLink to=\"/legal/security\">Seguridad</FooterLink>\n        </FooterCol>\n      </div>\n\n      {/* ----------------------------- BOTTOM BAR ------------------------------ */}\n      <div className=\"border-t border-gray-700\">\n        <div className=\"container mx-auto flex flex-col items-center justify-between gap-6 px-6 py-8 text-sm sm:flex-row\">\n          {/* Copy */}\n          <p className=\"text-gray-400\">\n            © {year} Rental‑MVP. Todos los derechos reservados.\n          </p>\n\n          {/* Social */}\n          <div className=\"flex gap-4\">\n            <SocialLink\n              href=\"https://github.com/juanjoarlandisg25\"\n              label=\"GitHub\"\n              icon={FaGithub}\n            />\n            <SocialLink\n              href=\"https://linkedin.com\"\n              label=\"LinkedIn\"\n              icon={FaLinkedin}\n            />\n            <SocialLink\n              href=\"https://twitter.com\"\n              label=\"Twitter\"\n              icon={FaTwitter}\n            />\n            <SocialLink\n              href=\"https://instagram.com\"\n              label=\"Instagram\"\n              icon={FaInstagram}\n            />\n          </div>\n        </div>\n      </div>\n    </footer>\n  );\n}\n\n/* ------------------------- Helpers & Sub‑components ------------------------ */\nfunction FooterCol({\n  title,\n  children,\n}: {\n  title: string;\n  children: React.ReactNode;\n}) {\n  return (\n    <div className=\"space-y-4\">\n      <h3 className=\"text-sm font-semibold uppercase tracking-wider text-white\">\n        {title}\n      </h3>\n      <nav className=\"space-y-2 text-sm\">{children}</nav>\n    </div>\n  );\n}\n\nfunction FooterLink({\n  to,\n  children,\n}: {\n  to: string;\n  children: React.ReactNode;\n}) {\n  return (\n    <Link\n      to={to}\n      className=\"transition-colors hover:text-white focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand\"\n    >\n      {children}\n    </Link>\n  );\n}\n\nfunction SocialLink({\n  href,\n  label,\n  icon: Icon,\n}: {\n  href: string;\n  label: string;\n  icon: React.ComponentType<{ className?: string }>;\n}) {\n  return (\n    <a\n      href={href}\n      title={label}\n      className=\"rounded-full p-2 text-gray-400 transition-colors hover:bg-gray-800 hover:text-white focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand\"\n      target=\"_blank\"\n      rel=\"noopener noreferrer\"\n    >\n      <Icon className=\"h-5 w-5\" />\n      <span className=\"sr-only\">{label}</span>\n    </a>\n  );\n}\n",
    "frontend/src/components/layout/Header.tsx": "/* -------------------------------------------------------------------------- */\n/*  src/components/layout/Header.tsx                                          */\n/* -------------------------------------------------------------------------- */\nimport { Fragment, useEffect, useState } from 'react';\nimport { Link, NavLink, useNavigate } from 'react-router-dom';\nimport { Disclosure, Menu, Transition } from '@headlessui/react';\nimport {\n  Bars3Icon,\n  XMarkIcon,\n  MoonIcon,\n  SunIcon,\n  UserCircleIcon,\n  ArrowLeftOnRectangleIcon,\n  ArrowRightOnRectangleIcon,\n} from '@heroicons/react/24/outline';\nimport logo from '../../assets/logo.png';\nimport { useAuth } from '../../hooks/useAuth';\nimport clsx from 'clsx';\n\n/* ------------------------------ Tema oscuro ------------------------------ */\nfunction ThemeToggle() {\n  const [dark, setDark] = useState(\n    () =>\n      localStorage.getItem('theme') === 'dark' ||\n      window.matchMedia('(prefers-color-scheme: dark)').matches,\n  );\n\n  useEffect(() => {\n    const cls = document.documentElement.classList;\n    dark ? cls.add('dark') : cls.remove('dark');\n    localStorage.setItem('theme', dark ? 'dark' : 'light');\n  }, [dark]);\n\n  return (\n    <button\n      title=\"Cambiar tema\"\n      onClick={() => setDark(!dark)}\n      className=\"rounded-md p-2 hover:bg-gray-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand dark:hover:bg-gray-700\"\n    >\n      {dark ? <SunIcon className=\"h-5 w-5\" /> : <MoonIcon className=\"h-5 w-5\" />}\n      <span className=\"sr-only\">Cambiar tema</span>\n    </button>\n  );\n}\n\n/* -------------------------------------------------------------------------- */\n/*                                    Header                                  */\n/* -------------------------------------------------------------------------- */\nexport default function Header() {\n  const { token, logout } = useAuth();\n  const navigate = useNavigate();\n\n  /* efecto blur‑>sólido */\n  const [scrolled, setScrolled] = useState(false);\n  useEffect(() => {\n    const onScroll = () => setScrolled(window.scrollY > 8);\n    onScroll();\n    window.addEventListener('scroll', onScroll);\n    return () => window.removeEventListener('scroll', onScroll);\n  }, []);\n\n  /* enlaces del panel móvil */\n  const mobileLinks = token\n    ? [\n        { to: '/dashboard', label: 'Perfil', icon: UserCircleIcon },\n        { label: 'Salir', action: logout, icon: ArrowLeftOnRectangleIcon },\n      ]\n    : [\n        { to: '/login', label: 'Entrar', icon: ArrowRightOnRectangleIcon },\n        { to: '/register', label: 'Crear cuenta', icon: UserCircleIcon },\n      ];\n\n  /* acción primaria escritorio: botón Login o Avatar */\n  const PrimaryAction = () =>\n    token ? (\n      <Menu as=\"div\" className=\"relative\">\n        <Menu.Button\n          className=\"rounded-full p-1 text-gray-600 hover:bg-gray-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand dark:hover:bg-gray-700\"\n          aria-label=\"Abrir menú de usuario\"\n        >\n          <UserCircleIcon className=\"h-8 w-8\" />\n        </Menu.Button>\n        <Transition\n          as={Fragment}\n          enter=\"transition ease-out duration-100\"\n          enterFrom=\"transform scale-95 opacity-0\"\n          enterTo=\"transform scale-100 opacity-100\"\n          leave=\"transition ease-in duration-75\"\n          leaveFrom=\"transform scale-100 opacity-100\"\n          leaveTo=\"transform scale-95 opacity-0\"\n        >\n          <Menu.Items className=\"absolute right-0 mt-2 w-44 rounded-md bg-white py-2 shadow-lg ring-1 ring-black/5 dark:bg-gray-800\">\n            <Menu.Item>\n              {({ active }) => (\n                <button\n                  onClick={() => navigate('/dashboard')}\n                  className={clsx(\n                    'flex w-full items-center gap-2 px-4 py-2 text-sm',\n                    active && 'bg-gray-100 dark:bg-gray-700',\n                  )}\n                >\n                  <UserCircleIcon className=\"h-5 w-5\" />\n                  Perfil\n                </button>\n              )}\n            </Menu.Item>\n            <Menu.Item>\n              {({ active }) => (\n                <button\n                  onClick={logout}\n                  className={clsx(\n                    'flex w-full items-center gap-2 px-4 py-2 text-sm text-red-600',\n                    active && 'bg-gray-100 dark:bg-gray-700',\n                  )}\n                >\n                  <ArrowLeftOnRectangleIcon className=\"h-5 w-5\" />\n                  Salir\n                </button>\n              )}\n            </Menu.Item>\n          </Menu.Items>\n        </Transition>\n      </Menu>\n    ) : (\n      <Link\n        to=\"/login\"\n        className=\"inline-flex items-center gap-1 rounded-md bg-brand px-4 py-2 text-sm font-semibold text-white shadow hover:bg-brand-hover dark:bg-brand-dark dark:hover:bg-brand-hover-dark\"\n      >\n        <ArrowRightOnRectangleIcon className=\"h-4 w-4\" />\n        Entrar\n      </Link>\n    );\n\n  return (\n    <Disclosure\n      as=\"header\"\n      className={clsx(\n        'sticky top-0 z-40 w-full backdrop-blur transition-colors supports-backdrop-blur:bg-white/40',\n        scrolled\n          ? 'bg-white/90 shadow-sm dark:bg-gray-900/90'\n          : 'bg-white/60 dark:bg-gray-900/60',\n      )}\n    >\n      {({ open }) => (\n        <>\n          {/* --------------------- barra principal --------------------- */}\n          <div className=\"container mx-auto flex items-center justify-between gap-4 px-4 py-3 md:py-4\">\n            {/* logo */}\n            <Link to=\"/\" aria-label=\"Inicio\" className=\"flex items-center gap-2\">\n              <img\n                src={logo}\n                alt=\"Rental‑MVP\"\n                className=\"h-8 w-auto select-none md:h-10\"\n                decoding=\"async\"\n              />\n            </Link>\n\n            {/* búsqueda (oculta en móvil) */}\n            <input\n              type=\"search\"\n              placeholder=\"Buscar ítem…\"\n              className=\"hidden w-full max-w-sm rounded-md border-gray-300 bg-white px-4 py-2 text-sm focus:border-brand focus:ring-brand dark:border-gray-700 dark:bg-gray-800 md:block\"\n            />\n\n            {/* acciones */}\n            <div className=\"flex items-center gap-3\">\n              <ThemeToggle />\n\n              {/* escritorio primary action */}\n              <div className=\"hidden md:block\">\n                <PrimaryAction />\n              </div>\n\n              {/* hamburguesa mobile */}\n              <Disclosure.Button\n                aria-label=\"Abrir menú\"\n                className=\"rounded-md p-2 hover:bg-gray-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand dark:hover:bg-gray-700 md:hidden\"\n              >\n                {open ? <XMarkIcon className=\"h-6 w-6\" /> : <Bars3Icon className=\"h-6 w-6\" />}\n              </Disclosure.Button>\n            </div>\n          </div>\n\n          {/* --------------------- panel móvil ----------------------- */}\n          <Transition\n            show={open}\n            enter=\"transition duration-150 ease-out\"\n            enterFrom=\"opacity-0 -translate-y-2\"\n            enterTo=\"opacity-100 translate-y-0\"\n            leave=\"transition duration-100 ease-in\"\n            leaveFrom=\"opacity-100 translate-y-0\"\n            leaveTo=\"opacity-0 -translate-y-2\"\n          >\n            <Disclosure.Panel className=\"border-t border-gray-200 bg-white/95 px-4 pb-6 dark:border-gray-700 dark:bg-gray-900/95 md:hidden\">\n              <nav className=\"flex flex-col gap-4 pt-6 text-base font-medium\">\n                {mobileLinks.map(({ to, label, action, icon: Icon }) =>\n                  action ? (\n                    <Disclosure.Button\n                      key={label}\n                      as=\"button\"\n                      onClick={action}\n                      className=\"flex items-center gap-2 rounded-md p-2 text-left transition-colors hover:text-brand focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand\"\n                    >\n                      <Icon className=\"h-5 w-5\" />\n                      {label}\n                    </Disclosure.Button>\n                  ) : (\n                    <Disclosure.Button\n                      key={label}\n                      as={NavLink}\n                      to={to!}\n                      className={({ isActive }: { isActive: boolean }) =>\n                        clsx(\n                          'flex items-center gap-2 rounded-md p-2 transition-colors hover:text-brand focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand',\n                          isActive && 'text-brand',\n                        )\n                      }\n                    >\n                      <Icon className=\"h-5 w-5\" />\n                      {label}\n                    </Disclosure.Button>\n                  ),\n                )}\n              </nav>\n            </Disclosure.Panel>\n          </Transition>\n        </>\n      )}\n    </Disclosure>\n  );\n}\n",
    "frontend/src/components/Home/FlowSteps.tsx": "/* -------------------------------------------------------------- */\n/*  FlowSteps – 4 pasos & garantía                                 */\n/* -------------------------------------------------------------- */\nimport { forwardRef } from 'react';\nimport {\n  CloudArrowUpIcon,\n  CalendarDaysIcon,\n  BanknotesIcon,\n  ShieldCheckIcon,\n} from '@heroicons/react/24/solid';\nimport Container from '../shared/Container';\nimport Section from '../shared/Section';\n\nconst STEPS = [\n  ['Publica',         'Sube tu artículo en 3 min y define reglas.',   CloudArrowUpIcon],\n  ['Reserva',         'Recibe la solicitud y la fianza al instante.', CalendarDaysIcon],\n  ['Gana',            'Entrega el ítem y cobra automáticamente.',     BanknotesIcon],\n  ['Devuelve seguro', 'Verifica estado y libera la fianza.',          ShieldCheckIcon],\n];\n\nexport default forwardRef<HTMLDivElement>(function FlowSteps(_, ref) {\n  return (\n    <Section title=\"¿Cómo funciona?\" className=\"bg-gray-100 dark:bg-gray-800\">\n      <Container>\n        <div\n          ref={ref}\n          className=\"grid gap-12 md:grid-cols-4\"\n        >\n          {STEPS.map(([t, d, I]) => {\n            const Icon = I as typeof CloudArrowUpIcon;\n            return (\n              <article\n                key={t as string}\n                className=\"\n                  fade-in space-y-4 rounded-lg bg-white p-6 text-center\n                  shadow transition hover:shadow-md dark:bg-gray-700 dark:shadow-gray-800\n                \"\n              >\n                <div className=\"mx-auto flex h-14 w-14 items-center justify-center rounded-full bg-brand/10 dark:bg-brand/20\">\n                  <Icon className=\"h-6 w-6 text-brand\" />\n                </div>\n                <h3 className=\"text-lg font-semibold\">{t}</h3>\n                <p className=\"text-sm text-gray-600 dark:text-gray-300\">{d}</p>\n                {t === 'Devuelve seguro' && (\n                  <p className=\"text-xs text-gray-500 dark:text-gray-400\">\n                    Sin costes ocultos · Comisión 8 % solo al cobrar\n                  </p>\n                )}\n              </article>\n            );\n          })}\n        </div>\n      </Container>\n    </Section>\n  );\n});\n",
    "frontend/src/components/Home/TrustBar.tsx": "/* -------------------------------------------------------------------------- */\n/*  src/components/Home/TrustBar.tsx                                          */\n/* -------------------------------------------------------------------------- */\nexport default function TrustBar() {\n  const BADGES = [\n    ['https://img.shields.io/badge/Stripe-635BFF?style=for-the-badge&logo=stripe&logoColor=white', 'Stripe'],\n    ['https://img.shields.io/badge/SSL%20256--bit-22C55E?style=for-the-badge&logoColor=white', 'SSL 256‑bit'],\n    ['https://img.shields.io/badge/Seguro%20AXA-0055A4?style=for-the-badge&logo=axa&logoColor=white', 'Seguro AXA'],\n    ['https://img.shields.io/badge/Protecci%C3%B3n-100%25-FFAA00?style=for-the-badge&logoColor=white', 'Protección 100 %'],\n  ] as const;\n\n  return (\n    <ul\n      className=\"\n        mt-10 grid grid-cols-2 gap-4 sm:grid-cols-4\n        text-center text-[0.7rem] font-medium text-white/90\n        opacity-90 [@media(prefers-reduced-motion:reduce)]:animate-none\n      \"\n    >\n      {BADGES.map(([src, label]) => (\n        <li key={label} className=\"flex flex-col items-center gap-1\">\n          {/* Logo */}\n          <img\n            src={src}\n            alt={label}\n            className=\"h-6 w-auto object-contain\"\n            loading=\"lazy\"\n            width={88}\n            height={24}\n          />\n          {/* Texto */}\n          <span className=\"leading-tight\">{label}</span>\n        </li>\n      ))}\n    </ul>\n  );\n}\n",
    "frontend/src/components/Home/FAQ.tsx": "/**\n * FAQ – Accessible Accordion (WAI–ARIA Disclosure Pattern)\n * • Animación fade‑in con Intersection Observer\n * • Soporta prefers‑reduced‑motion\n */\nimport { Disclosure, Transition } from '@headlessui/react';\nimport { ChevronDownIcon } from '@heroicons/react/24/solid';\nimport { useEffect, useRef } from 'react';\nimport Container from '../shared/Container';\n\nconst FAQS: [string, string][] = [\n  [\n    '¿Cómo se gestionan los pagos?',\n    'Usamos Stripe Connect para retener la fianza y liberar el pago una vez devuelto el ítem.',\n  ],\n  [\n    '¿Qué pasa si mi herramienta se daña?',\n    'Dispones de un seguro opcional a todo riesgo y un sistema de valoraciones para vetar a malos usuarios.',\n  ],\n  ['¿Puedo cancelar una reserva?', 'Sí, hasta 12 h antes sin penalización.'],\n  ['¿Hay comisión?', 'Solo cobramos un 8 % al propietario cuando se confirma el alquiler.'],\n];\n\nexport default function FAQ({ className = '' }: { className?: string }) {\n  const ref = useRef<HTMLDivElement>(null);\n\n  /* Fade‑in when section enters viewport */\n  useEffect(() => {\n    const el = ref.current;\n    if (!el) return;\n    const io = new IntersectionObserver(\n      ([e]) => e.isIntersecting && el.classList.add('visible'),\n      { threshold: 0.2 }\n    );\n    io.observe(el);\n    return () => io.disconnect();\n  }, []);\n\n  return (\n    <section ref={ref} className={`${className} fade-in`}>\n      <Container>\n        <h2 className=\"mb-8 text-center text-3xl font-bold\">Preguntas frecuentes</h2>\n\n        <div className=\"mx-auto max-w-3xl divide-y divide-gray-200 dark:divide-gray-700\">\n          {FAQS.map(([q, a]) => (\n            <Disclosure key={q} as=\"div\" className=\"py-4\">\n              {({ open }) => (\n                <>\n                  <Disclosure.Button\n                    className=\"flex w-full items-center justify-between text-left text-lg font-medium focus:outline-none focus-visible:ring focus-visible:ring-brand/40\"\n                    aria-label={open ? `Cerrar ${q}` : `Abrir ${q}`}\n                  >\n                    <span>{q}</span>\n                    <ChevronDownIcon\n                      className={`h-6 w-6 transition-transform ${open ? 'rotate-180' : ''}`}\n                    />\n                  </Disclosure.Button>\n                  <Transition\n                    show={open}\n                    enter=\"transition duration-200 ease-out\"\n                    enterFrom=\"transform scale-y-95 opacity-0\"\n                    enterTo=\"transform scale-y-100 opacity-100\"\n                    leave=\"transition duration-150 ease-in\"\n                    leaveFrom=\"transform scale-y-100 opacity-100\"\n                    leaveTo=\"transform scale-y-95 opacity-0\"\n                  >\n                    <Disclosure.Panel className=\"pt-3 text-gray-600 dark:text-gray-300\">\n                      {a}\n                    </Disclosure.Panel>\n                  </Transition>\n                </>\n              )}\n            </Disclosure>\n          ))}\n        </div>\n      </Container>\n    </section>\n  );\n}\n",
    "frontend/src/components/Home/IncentiveBanner.tsx": "/* -------------------------------------------------------------- */\n/*  IncentiveBanner – FOMO                                        */\n/* -------------------------------------------------------------- */\nimport { Link } from 'react-router-dom';\nimport Container from '../shared/Container';\nimport { ArrowRightIcon } from '@heroicons/react/24/solid';\n\nexport default function IncentiveBanner() {\n  return (\n    <section\n      className=\"\n        relative bg-brand py-14 text-center text-white\n        before:absolute before:inset-0 before:-z-10\n        before:bg-[radial-gradient(circle_at_center,rgba(255,255,255,0.18),transparent)]\n      \"\n    >\n      <Container>\n        <h2 className=\"mb-3 text-3xl font-bold\">5 € de regalo en tu primera reserva</h2>\n        <p className=\"mb-6 text-sm\">Solo para los primeros 100 registros de julio</p>\n        <Link to=\"/register\" className=\"btn inline-flex gap-2\">\n          Aprovechar cupón\n          <ArrowRightIcon className=\"h-5 w-5\" />\n        </Link>\n      </Container>\n    </section>\n  );\n}\n",
    "frontend/src/components/Home/Stats.tsx": "/**\n * Stats – Animated count‑up respecting prefers‑reduced‑motion\n * • Starts counting when component enters viewport\n */\nimport { useEffect, useRef, useState } from 'react';\nimport Container from '../shared/Container';\n\nconst DATA = [\n  { label: 'Ítems publicados', value: 3124 },\n  { label: 'Usuarios registrados', value: 857 },\n  { label: '€ ahorrados', value: 24367 },\n];\n\nexport default function Stats() {\n  const ref = useRef<HTMLDivElement>(null);\n  const [visible, setVisible] = useState(false);\n\n  useEffect(() => {\n    const el = ref.current;\n    if (!el) return;\n    const io = new IntersectionObserver(\n      ([e]) => e.isIntersecting && setVisible(true),\n      { threshold: 0.3 }\n    );\n    io.observe(el);\n    return () => io.disconnect();\n  }, []);\n\n  /* Count‑up util */\n  const Counter = ({ end }: { end: number }) => {\n    const [count, setCount] = useState(0);\n    useEffect(() => {\n      if (!visible) return;\n      if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {\n        setCount(end);\n        return;\n      }\n      let start = 0;\n      const duration = 1800; // ms\n      const startTime = performance.now();\n      const step = (ts: number) => {\n        const progress = Math.min((ts - startTime) / duration, 1);\n        const val = Math.floor(progress * (end - start) + start);\n        setCount(val);\n        if (progress < 1) requestAnimationFrame(step);\n      };\n      requestAnimationFrame(step);\n    }, [visible, end]);\n    return <>{count.toLocaleString('es-ES')}</>;\n  };\n\n  return (\n    <section ref={ref} className=\"bg-white py-12 dark:bg-gray-800\">\n      <Container>\n        <div className=\"grid gap-8 sm:grid-cols-3\">\n          {DATA.map(({ label, value }) => (\n            <div key={label} className=\"text-center\">\n              <p className=\"text-4xl font-extrabold text-brand\">\n                <Counter end={value} />\n              </p>\n              <p className=\"mt-2 text-sm font-medium text-gray-600 dark:text-gray-300\">\n                {label}\n              </p>\n            </div>\n          ))}\n        </div>\n      </Container>\n    </section>\n  );\n}\n",
    "frontend/src/components/Home/LogoCloud.tsx": "/**\n * LogoCloud – Continuous marquee animation (CSS‑only)\n * • Pausas en hover y respeta prefers‑reduced‑motion\n * • Optimiza logos con loading=\"lazy\" y alt descriptivo\n */\nimport Container from '../shared/Container';\n\nconst LOGOS = [\n  { src: 'https://dummyimage.com/160x60/cccccc/ffffff&text=Bosch', alt: 'Bosch' },\n  { src: 'https://dummyimage.com/160x60/cccccc/ffffff&text=Makita', alt: 'Makita' },\n  { src: 'https://dummyimage.com/160x60/cccccc/ffffff&text=Black+%26+Decker', alt: 'Black & Decker' },\n  { src: 'https://dummyimage.com/160x60/cccccc/ffffff&text=Dewalt', alt: 'Dewalt' },\n  { src: 'https://dummyimage.com/160x60/cccccc/ffffff&text=GoPro', alt: 'GoPro' },\n  { src: 'https://dummyimage.com/160x60/cccccc/ffffff&text=Xiaomi', alt: 'Xiaomi' },\n];\n\nexport default function LogoCloud() {\n  /* Duplicate array for seamless loop */\n  const logos = [...LOGOS, ...LOGOS];\n\n  return (\n    <section className=\"bg-gray-50 py-12 dark:bg-gray-900\">\n      <Container>\n        <div className=\"overflow-hidden\">\n          <ul className=\"flex animate-marquee space-x-12 hover:[animation-play-state:paused]\">\n            {logos.map((l, i) => (\n              <li key={`${l.alt}-${i}`} className=\"shrink-0\">\n                <img\n                  src={l.src}\n                  alt={l.alt}\n                  className=\"h-12 w-auto object-contain grayscale hover:grayscale-0\"\n                  loading=\"lazy\"\n                />\n              </li>\n            ))}\n          </ul>\n        </div>\n      </Container>\n    </section>\n  );\n}\n",
    "frontend/src/components/Home/Testimonials.tsx": "/**\n * Testimonials – Accessible slider (buttons & keyboard)\n * • Pure React state, no external carousel deps\n * • Auto‑advance pauses on hover / focus\n */\nimport { useEffect, useState, useRef } from 'react';\nimport { ChevronLeftIcon, ChevronRightIcon } from '@heroicons/react/24/solid';\nimport Container from '../shared/Container';\n\nconst TESTIMONIALS = [\n  {\n    name: 'Laura P.',\n    text: 'Alquilé mi cámara reflex y pagué las vacaciones. ¡Súper fácil!',\n    avatar: 'https://source.unsplash.com/48x48/?woman,face',\n  },\n  {\n    name: 'Carlos G.',\n    text: 'Encontré un taladro a 5 € y no tuve que comprar uno nuevo.',\n    avatar: 'https://source.unsplash.com/48x48/?man,face',\n  },\n  {\n    name: 'Marta S.',\n    text: 'Me encanta la seguridad del pago con fianza. Repetiré.',\n    avatar: 'https://source.unsplash.com/48x48/?lady,face',\n  },\n];\n\nexport default function Testimonials({ className = '' }: { className?: string }) {\n  const [index, setIndex] = useState(0);\n  const timer = useRef<NodeJS.Timeout | null>(null);\n\n  /* Auto‑advance every 6 s */\n  useEffect(() => {\n    startAuto();\n    return () => clearAuto();\n  }, [index]);\n\n  const clearAuto = () => timer.current && clearTimeout(timer.current);\n  const startAuto = () => {\n    clearAuto();\n    timer.current = setTimeout(() => {\n      setIndex((i) => (i + 1) % TESTIMONIALS.length);\n    }, 6000);\n  };\n\n  const goTo = (i: number) => {\n    setIndex(i);\n  };\n\n  return (\n    <section\n      className={`${className} relative py-16 bg-white dark:bg-gray-900`}\n      onMouseEnter={clearAuto}\n      onMouseLeave={startAuto}\n    >\n      <Container>\n        <h2 className=\"mb-10 text-center text-3xl font-bold\">Historias reales</h2>\n\n        <div className=\"relative mx-auto max-w-lg overflow-hidden\">\n          {TESTIMONIALS.map((t, i) => (\n            <article\n              key={t.name}\n              aria-hidden={i !== index}\n              className={`transition-transform duration-500 ease-out ${\n                i === index ? 'translate-x-0' : 'translate-x-full'\n              } absolute inset-0 flex flex-col items-center text-center`}\n            >\n              <img\n                src={t.avatar}\n                alt={`Avatar de ${t.name}`}\n                className=\"h-14 w-14 rounded-full object-cover\"\n                loading=\"lazy\"\n              />\n              <p className=\"mt-4 max-w-md text-lg font-medium text-gray-800 dark:text-gray-200\">\n                “{t.text}”\n              </p>\n              <span className=\"mt-2 text-sm text-gray-600 dark:text-gray-400\">{t.name}</span>\n            </article>\n          ))}\n        </div>\n\n        {/* Controls */}\n        <div className=\"mt-8 flex items-center justify-center gap-6\">\n          <button\n            onClick={() => goTo((index + TESTIMONIALS.length - 1) % TESTIMONIALS.length)}\n            aria-label=\"Anterior testimonio\"\n            className=\"rounded-full p-2 hover:bg-gray-100 focus:outline-none focus-visible:ring focus-visible:ring-brand/40 dark:hover:bg-gray-800\"\n          >\n            <ChevronLeftIcon className=\"h-6 w-6\" />\n          </button>\n          <button\n            onClick={() => goTo((index + 1) % TESTIMONIALS.length)}\n            aria-label=\"Siguiente testimonio\"\n            className=\"rounded-full p-2 hover:bg-gray-100 focus:outline-none focus-visible:ring focus-visible:ring-brand/40 dark:hover:bg-gray-800\"\n          >\n            <ChevronRightIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n      </Container>\n    </section>\n  );\n}\n",
    "frontend/src/components/Home/Benefits.tsx": "/* -------------------------------------------------------------------------- */\n/*  src/components/Home/Benefits.tsx                                          */\n/* -------------------------------------------------------------------------- */\n/*  • Sección “Por qué elegirnos” con 4 tarjetas animadas                     */\n/*  • Accesibilidad AA, dark‑mode parity, animación fade‑in intersección      */\n/* -------------------------------------------------------------------------- */\n\nimport { useEffect, useRef } from 'react';\nimport {\n  ShieldCheckIcon,\n  UsersIcon,\n  GlobeAltIcon,\n  LifebuoyIcon,\n} from '@heroicons/react/24/solid';\n\nimport Container from '../shared/Container';\nimport Section   from '../shared/Section';\n\n/* ---------- Copys & datos (fácilmente traducibles/actualizables) ---------- */\nconst BENEFITS = [\n  {\n    icon: ShieldCheckIcon,\n    title: 'Pagos 100 % seguros',\n    desc : 'Stripe Connect y escrow de fianzas protegen cada transacción.',\n  },\n  {\n    icon: UsersIcon,\n    title: 'Comunidad verificada',\n    desc : 'Valoración media 4,8/5 y perfiles autenticados.',\n  },\n  {\n    icon: GlobeAltIcon,\n    title: 'Ahorro sostenible',\n    desc : 'Reduce hasta un 70 % frente a la compra y cuida el planeta.',\n  },\n  {\n    icon: LifebuoyIcon,\n    title: 'Seguro a todo riesgo',\n    desc : 'Cobertura automática de hasta 1 000 € por artículo.',\n  },\n];\n\n/* -------------------------------------------------------------------------- */\n/*                             Componente principal                           */\n/* -------------------------------------------------------------------------- */\nexport default function Benefits() {\n  const ref = useRef<HTMLDivElement>(null);\n\n  /* Fade‑in cuando la sección entra en viewport --------------------------- */\n  useEffect(() => {\n    const el = ref.current;\n    if (!el) return;\n    const io = new IntersectionObserver(\n      (entries) =>\n        entries.forEach((e) => e.isIntersecting && e.target.classList.add('visible')),\n      { threshold: 0.2 }\n    );\n    el.querySelectorAll('.fade-in').forEach((c) => io.observe(c));\n    return () => io.disconnect();\n  }, []);\n\n  return (\n    <Section title=\"Por qué elegirnos\">\n      <Container>\n        <div ref={ref} className=\"grid gap-8 md:grid-cols-4\">\n          {BENEFITS.map(({ icon: Icon, title, desc }) => (\n            <article\n              key={title}\n              className=\"\n                fade-in space-y-3 rounded-lg bg-white p-6 text-center\n                shadow transition hover:shadow-md dark:bg-gray-800 dark:shadow-gray-700\n              \"\n            >\n              <Icon className=\"mx-auto h-12 w-12 text-brand\" />\n              <h3 className=\"text-xl font-semibold dark:text-gray-100\">{title}</h3>\n              <p className=\"text-gray-600 dark:text-gray-300\">{desc}</p>\n            </article>\n          ))}\n        </div>\n      </Container>\n    </Section>\n  );\n}\n",
    "frontend/src/components/Home/CategoryGrid.tsx": "/* -------------------------------------------------------------- */\n/*  CategoryGrid – primer clic rápido                              */\n/* -------------------------------------------------------------- */\nimport { Link } from 'react-router-dom';\nimport Container from '../shared/Container';\nimport Section from '../shared/Section';\nimport {\n  WrenchScrewdriverIcon,\n  CameraIcon,\n  DevicePhoneMobileIcon,\n  AcademicCapIcon,\n  PresentationChartBarIcon,\n  TruckIcon,\n} from '@heroicons/react/24/outline';\n\nconst CATS = [\n  { icon: WrenchScrewdriverIcon, name: 'Herramientas' },\n  { icon: TruckIcon,             name: 'Jardín' },\n  { icon: CameraIcon,            name: 'Fotografía' },\n  { icon: AcademicCapIcon,       name: 'Deporte' },\n  { icon: DevicePhoneMobileIcon, name: 'Electrónica' },\n  { icon: PresentationChartBarIcon, name: 'Bebé & movilidad' },\n];\n\nexport default function CategoryGrid() {\n  return (\n    <Section title=\"Explora por categoría\" className=\"bg-white dark:bg-gray-900\">\n      <Container>\n        <p className=\"mx-auto mb-10 max-w-lg text-center text-gray-600 dark:text-gray-400\">\n          Busca por categoría y encuentra lo que necesitas en segundos\n        </p>\n        <div className=\"grid gap-6 sm:grid-cols-3 md:grid-cols-6\">\n          {CATS.map(({ icon: Icon, name }) => (\n            <Link\n              key={name}\n              to={`/dashboard?cat=${encodeURIComponent(name)}`}\n              className=\"\n                group flex flex-col items-center gap-3 rounded-lg bg-gray-50 p-6\n                text-center shadow transition hover:-translate-y-1 hover:bg-gray-100\n                dark:bg-gray-800 dark:hover:bg-gray-700\n              \"\n            >\n              <Icon className=\"h-8 w-8 text-brand transition group-hover:scale-110\" />\n              <span className=\"text-sm font-medium\">{name}</span>\n            </Link>\n          ))}\n        </div>\n      </Container>\n    </Section>\n  );\n}\n",
    "frontend/src/components/filters/FiltersSidebar.tsx": "import { Disclosure } from '@headlessui/react';\nimport useCategories, { Category } from '../../features/categories/useCategories';\n\ntype Filters = {\n  name?: string;\n  min_price?: number;\n  max_price?: number;\n  categories?: number[];\n  order?: 'price_asc' | 'price_desc' | 'name';\n};\n\ntype Props = {\n  value: Filters;\n  onChange: (f: Filters) => void;\n  onReset: () => void;\n};\n\nexport default function FiltersSidebar({ value, onChange, onReset }: Props) {\n  const { data: cats } = useCategories();\n\n  const toggleCat = (id: number) => {\n    const list = new Set(value.categories ?? []);\n    list.has(id) ? list.delete(id) : list.add(id);\n    onChange({ ...value, categories: [...list] });\n  };\n\n  return (\n    <div className=\"space-y-6 w-full md:w-60 lg:w-72\">\n      {/* Search */}\n      <input\n        placeholder=\"Buscar…\"\n        className=\"form-input w-full\"\n        value={value.name ?? ''}\n        onChange={e => onChange({ ...value, name: e.target.value || undefined })}\n      />\n\n      {/* Price */}\n      <Disclosure defaultOpen>\n        {({ open }) => (\n          <>\n            <Disclosure.Button className=\"flex w-full justify-between text-sm font-semibold\">\n              Precio {open ? '−' : '+'}\n            </Disclosure.Button>\n            <Disclosure.Panel className=\"mt-3 space-y-2\">\n              <input\n                type=\"number\"\n                min={0}\n                step={0.1}\n                placeholder=\"mín\"\n                className=\"form-input w-full\"\n                value={value.min_price ?? ''}\n                onChange={e =>\n                  onChange({\n                    ...value,\n                    min_price: e.target.value ? Number(e.target.value) : undefined\n                  })\n                }\n              />\n              <input\n                type=\"number\"\n                min={0}\n                step={0.1}\n                placeholder=\"máx\"\n                className=\"form-input w-full\"\n                value={value.max_price ?? ''}\n                onChange={e =>\n                  onChange({\n                    ...value,\n                    max_price: e.target.value ? Number(e.target.value) : undefined\n                  })\n                }\n              />\n            </Disclosure.Panel>\n          </>\n        )}\n      </Disclosure>\n\n      {/* Categories */}\n      <Disclosure defaultOpen>\n        {({ open }) => (\n          <>\n            <Disclosure.Button className=\"flex w-full justify-between text-sm font-semibold\">\n              Categorías {open ? '−' : '+'}\n            </Disclosure.Button>\n            <Disclosure.Panel className=\"mt-3 flex flex-wrap gap-2\">\n              {cats.map((c: Category) => {\n                const active = value.categories?.includes(c.id);\n                return (\n                  <button\n                    key={c.id}\n                    onClick={() => toggleCat(c.id)}\n                    className={\n                      active\n                        ? 'rounded-full bg-brand px-3 py-0.5 text-xs font-medium text-white'\n                        : 'rounded-full border px-3 py-0.5 text-xs text-gray-600'\n                    }\n                  >\n                    {c.name}\n                  </button>\n                );\n              })}\n            </Disclosure.Panel>\n          </>\n        )}\n      </Disclosure>\n\n      {/* Order */}\n      <select\n        className=\"form-select w-full\"\n        value={value.order ?? ''}\n        onChange={e =>\n          onChange({\n            ...value,\n            order: e.target.value ? (e.target.value as Filters['order']) : undefined\n          })\n        }\n      >\n        <option value=\"\">Ordenar por…</option>\n        <option value=\"price_asc\">Precio ↑</option>\n        <option value=\"price_desc\">Precio ↓</option>\n        <option value=\"name\">Nombre</option>\n      </select>\n\n      <button onClick={onReset} className=\"btn--ghost w-full\">\n        Limpiar filtros\n      </button>\n    </div>\n  );\n}\n"
}